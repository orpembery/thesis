\section{Introduction}
This chapter has two main foci:
\ben
\item Recapping theory for the deterministic Helmholtz equation in heterogeneous media, especially well-posedness results and a priori bounds on the solution, and
\item Recapping and extending theory of the finite-element method (FEM) for the deterministic heterogeneous Helmholtz equation, especially error bounds.
  \een

%%   In this chapter we will first provide an overview of well-posedness results for the deterministic Helmholtz equation, and a priori bounds on its solution. Such results are more complicated than analagous results for the simpler stationary diffusion equation
%%   \beq\label{eq:stdiff}
%% \grad \cdot \mleft( A \grad u \mright) = -f,
%% \eeq
%% as results for the Helmholtz equation depend on whether the medium described by the coefficients $A$ and $n$ is `trapping' or `nontrapping' (these terms will be discussed in more precision below). We will then move on to discussing the finite-element approximation of \eqref{eq:introdet}, focussing especially on error bounds and quasi-optimality, and the $k$-dependent mesh conditions under which such properties can be proven.

In \cref{sec:detprobs} we  define two Helmholtz problems, one on an infinite exterior domain, and the other on a truncated domain, and discuss their physical relevance. In \cref{sec:wpbounds} we  recap in some detail the well-posedness results and a priori bounds from \cite{GrPeSp:19}; these results will be crucial for our analysis of stochastic Helmholtz problems in \cref{chap:stochastic}. Then in \cref{sec:wpdisc} we set these results in their wider context with a review of the related literature. We  then move on to the FEM for \eqref{eq:introdet}; in \cref{sec:varform} we give the variational formulations of our two Helmholtz problems. In \cref{sec:fetheory} we recap basic concepts of the FEM, and in in \cref{sec:helmfedisc,sec:prooftechniques} we  give an overview of the literature on error bounds and quasi-optimality for the Helmholtz equation, including an extended discussion of proof techniques for these results. Finally in \cref{sec:fem} we  prove new error bounds for the FEM for the heterogeneous Helmholtz equation. 


\section[PDE theory of the Helmholtz Equation]{Wavenumber- and coefficient-explicit PDE theory of the deterministic Helmholtz equation}\label{sec:pdetheory}
  We  begin by defining the two deterministic Helmholtz problems that we consider in this thesis; we  consider their stochastic counterparts in subsequent chapters.

\subsection{Deterministic Helmholtz problems}\label{sec:detprobs}

We first state our problems of interest, largely following the presentation in \cite{GrPeSp:19}

We first introduce some function spaces. We let $\spd$ be the set of all symmetric-positive-definite matrices in $\RRdtd$. For $D \subseteq \RRd,$ let $\LiDRRdtd$ be the set of all matrix-valued functions $A:D\rightarrow\spd$ such that $A_{i,j} \in \LiDRR$ for all $i,j =   1,\ldots,d.$ Where the range of functions is $\CC$ we suppress the second argument in a function space, e.g.~writing $\LtD$ for $\LtDCC.$

  \bprob[Exterior Dirichlet Problem (EDP)]\label{prob:edp}
  Let $\Dm$ be a bounded Lipschitz open set such that the open complement $\Dp \de \RRd \setminus \Dmclos$ is connected and let $\GD \de \partial \Dm.$ Let $\trD:\HoD\rightarrow\HhGD$ denote the Dirichlet trace operator on $\GD$. Given
  \bit
  \item $k > 0,$
\item $f \in \LtDp$ with compact support,
\item $\gD \in \HhGD,$
\item $n \in \LiDpRR$ such that $1-n$ has compact support and there exist $0 < \nmin < \nmax < \infty$ such that
  \beq\label{eq:nbounds}
\nmin \leq n(\bx) < \nmax \tfae \bx \in \Dp,
  \eeq
\item $A \in \LiDpRRdtd$ such that $I-A$ has compact support, $A$ is symmetric, and there exist $0 < \Amin < \Amax < \infty$ such that
  \beq\label{eq:Abounds}
\Amin \abs{\bxi}^2 \leq \mleft(A(\bx) \bxi \mright) \cdot \bxibar < \Amax \abs{\bxi}^2 \tfa \bxi \in \CCd \tfae \bx \in \Dp,
  \eeq
  \eit
  we say $u \in \HolocDp$ satisfies the \defn{exterior Dirichlet problem} if
  \beq\label{eq:hhedp}
\grad \cdot \mleft(A \grad u\mright) + k^2 n u = -f \tin \Dp,
\eeq
\beq\label{eq:dbc}
\trGD u = \gD,
\eeq
and $u$ satisfies the Sommerfeld radiation condition
\beq\label{eq:sommerfeld}
\dudr(\bx) - iku(\bx) = o\mleft(\frac1{r^{(d-1)/2}}\mright) \text{ as }r \de \abs{\bx} \rightarrow \infty,\text{ uniformly in }\bxhat \de \bx/\abs{\bx}.
\eeq
\eprob

As in \cite[pp. 2874-2875]{GrPeSp:19}, we note that \cref{eq:hhedp} is understood in the sense that
\beqs
\int_{\Dp} \mleft(A \grad u\mright)\cdot \grad \phibar - k^2 n u \phibar = \int_{\Dp} f \phibar \text{ for all } \phi \in \CzinftyDp,
\eeqs
and we can impose the radiation condition \cref{eq:sommerfeld} on $u$ even though $u$ only has weak first-order derivatives because $u$ is $C^\infty$ outside some ball, by elliptic regularity.

One particular case of \cref{prob:edp} is the sound-soft scattering problem, where $u$ is the acoustic pressure field resulting from the scattering of an incoming wave $\ui$ by the scatterer\footnote{In the literature the scattered field is sometimes denoted $\us,$ in which case $u$ usually denotes the total field $\ui+ \us.$} $\Dm,$ c.f., \cite[Section 1.1]{Ih:98} and \cite[Section 1.1]{CoKr:13} In this problem, the total field $\uT = u + \ui$ satisfies $\Lap\uT + k^2n\uT = 0$ in $\Dp,$ with $\trGD \uT = 0.$ If there are no sources in the domain, and the incident field satisfies $\Lap \ui + k^2 \ui = 0$ in $\Dp,$ then $u$ satisfies \cref{prob:edp} with $f = \grad \cdot \mleft(\mleft(A-I\mright) \grad \ui\mright) + k^2 \mleft(n-1\mright)\ui,$ and $\gD = - \trGD \ui$.

Physically, the Sommerfeld radiation condition \eqref{eq:sommerfeld} ensures that the solutions of \namecref{prob:edp} \ref{prob:edp} correspond to `outgoing' waves (see, e.g., \cite[Section 1.1.3]{Ih:98}), and mathematically, it guarantees the uniqueness of solution to \cref{prob:edp}, see, e.g., \cite[Corollary 2.9]{ChGrLaSp:12}. Observe that \cref{prob:edp} is defined on an infinite spatial domain; if one discretises \cref{prob:edp} using domain-based methods (such as FEMs) the infiniteness of the domain causes an issue. Therefore a common appproach is to truncate \cref{prob:edp} with an artificial boundary that is sufficiently large to contain $\Dm$ and all the inhomogeneities in $A$, $n,$ and $f.$

If one was able to compute the Dirichlet-to-Neumann operator for the \emph{homogeneous} Helmholtz equation in the exterior of the artificial boundary, then one could discretise \cref{prob:edp} exactly. See \cref{prob:vedp} for the variational formulation of \cref{prob:edp}, which is posed on a finite domain and includes the exact Dirichlet-to-Neumann operator. In practice, however, the Dirichlet-to-Neumann operator is expensive to compute, and so is approximated with a different boundary condition on the truncated boundary. Options for the truncated boundary condition include a perfectly matched layer, first introduced in \cite{Be:94} for Maxwell's equations, which mimics the whole of the external domain, or FEM-BEM coupling (a numerical method, where BEM stands for boundary-element method), as in, e.g., \cite{HiMe:06}, where a boundary element method is used to approximate the solution in the exterior of the truncated domain. However, in this thesis, as a model problem we consider imposing an \defn{impedance boundary condition}
\beq\label{eq:imptext}
\dn u - iku = \gI
\eeq
on the truncated boundary. If $\gI = 0,$ then \eqref{eq:imptext} can be seen as a first-order approximation to \eqref{eq:sommerfeld} (see, e.g., \cite[p. 353]{GaMuSp:19}, where it is shown that in certain asymptotic limits, the Dirichlet-to-Neumann map for the homogeneous Helmholtz equation is equal to $ik$). Moreover, We note that a common Helmholtz model problem in the numerical-analysis community is the \defn{interior impedance problem (IIP)}, where an impedance boundary condition \cref{eq:imptext} is used, and it is assumed that $\Dm = \emptyset.$ Truncating \cref{prob:edp} with an impedance boundary condition gives rise to the following deterministic Helmholtz problem.

\bprob[Truncated Exterior Dirichlet Problem (TEDP)]\label{prob:tedp}
 Let $\Dm$ be an open bounded Lip\-schitz set such that the open complement $\Dp \de \RRd \setminus \Dmclos$ is connected. Let $\Dtilde$ be a bounded connected Lipschitz open set such that $\Dmclos \compcont \Dtilde.$ Let $D \de \Dtilde \setminus \Dmclos$, $\GD \de \partial \Dm,$ and $\GI \de \partial \Dtilde.$ Let $\trI: \HoD\rightarrow\HhGI$ denote the Dirichlet trace operator on $\GI$, and $\dn:\HoD\rightarrow\HmhGI$ the Neumann trace operator. Given
  \bit
  \item $k > 0,$
\item $f \in \LtD$
\item $\gD \in \HhGD,$
  \item $\gI \in \LtGI$
\item $n \in \LiDRR$ such that $\supp\mleft(1-n\mright) \compcont D$ satisfying \eqref{eq:nbounds} with $\Dp$ replaced by $D$
\item $A \in \LiDRRdtd$ such that $\supp\mleft(I-A\mright)\compcont D$ and $A$ is symmetric, satisfying \eqref{eq:Abounds} with $\Dp$ replaced by $D$
  \eit
  we say $u \in \HoD$ satisfies the \defn{truncated exterior Dirichlet problem} if
  \beq\label{eq:tedp}
\grad \cdot \mleft(A \grad u\mright) + k^2 n u = -f \tin D,
\eeq
\beqs
\trGD u = \gD, \ton \GD \tand
\eeqs
\beq\label{eq:ibc}
\dn u - ik\trGI u = \gI \ton \GI.
\eeq
\eprob
Observe that, by construction, $\partial D = \GI \cup \GI$ and $\GD \cap \GI = \emptyset.$

\begin{figure}
\begin{centering}
\input{domain-diagram}
\caption[An example of the sets in the definitions of the Helmholtz Exterior Dirichlet Problem and Truncated Exterior Dirichlet Problem.]{An example of the sets $\Dm,$ $\GD$, $\BR$, {$\Dtilde$}, $D$, and $\GI$ and $\supp f$, $\supp(I-A)$, and $\supp(1-n)$ from \cref{prob:edp,prob:tedp}.\label{fig:domain}}
\end{centering}
\end{figure}

Whilst the impedance boundary condition \eqref{eq:ibc} is only an approximation to the Sommerfeld radiation condition \eqref{eq:sommerfeld}, the solutions of \cref{prob:tedp} are still `wave-like', and we  see below that the $k$-dependence of the solution operator of \cref{prob:tedp} is the same as that of \cref{prob:edp}.

  \subsection{Well-posedness and a priori bounds}\label{sec:wpbounds}

  We  now recap the well-posedness results and a priori bounds for \cref{prob:edp,prob:tedp} from \cite{GrPeSp:19}; these results will be crucial for proving well-posedness results and a priori bounds for the stochastic analogues of \cref{prob:edp,prob:tedp} in \cref{chap:stochastic}. The novelty of the bounds in \cite{GrPeSp:19} is that the results are for all $k$ and are explicit in $A$, $n$ and $k$; this explicitness is necessary in order to prove similar a priori bounds for stochastic $A$ and $n$. We prove these results under conditions on $A$ and $n$ that require $A$ and $n$ to be, in some sense, `nontrapping'. Informally, a medium is `nontrapping' if all rays travelling through the medium escape in a uniform time; this definition, and the sense in which our conditions are `nontrapping', is discussed in \cref{sec:wpdisc} below.

  We first define the classes of $A$ and $n$ that we consider.% Since we will need to consider the classes on both finite and infinite domains (for \cref{prob:tedp,prob:edp} respectively), we first define the classes for finite domains, before using this definition to define the classes for infinite domains.

%%   \bde[Class of nontrapping media on a finite domain]\label{def:NTfinite}
%% Let $\Dm$ be star-shaped with respect to the origin, and let $D$ be as in \cref{prob:tedp}. Let $A \in \CzoDclosRRdtd, n \in \CzoDclosRR$ and $\muo, \mut > 0.$ We say that 
  %%   \ede
  
\bde[Class of nontrapping media]\label{def:NT}
Let $A \in \CzoDpclosRRdtd, n \in \CzoDpclosRR,$ and $\muo,$ $\mut > 0.$ We say that $A \in \NTADp{\muo}$ if
\beq\label{eq:ANT}
A(\bx) - \mleft(\bx \cdot \grad\mright)A(\bx) \geq \muo,
\eeq
in the sense of quadratic forms, for almost every $\bx \in \Dp$. We say that $n \in \NTnDp{\mut}$ if
\beq\label{eq:nNT}
n(\bx) + \bx \cdot \grad n(\bx) \geq \mut
\eeq
for almost every $\bx \in \Dp.$

If $D$ is as in \cref{prob:tedp}, then we define $\NTAD{\muo}$ and $\NTnD{\mut}$ analagously.
\ede

\bre[\Cref{def:NT} makes sense]
Both $A$ and $n$ are supported inside some bounded Lipschitz open set $D$, and on such sets, $\CzoD = \WoiD$ (see, e.g., \cite[Section 4.2.3, Theorem 5]{EvGa:92}). Since $A$ and $n$ are both Lipschitz functions (from \cref{def:NT}), it follows that they are in $\WoiDRRdtd$ and $\WoiDRR$ respectively. By construction $A=I$ and $n=1$ outside $D$, and so it follows that $A \in \WoiDpclosRRdtd$ and $n \in \WoiDpclosRR,$ i.e., $A$ and $n$ have weak first-order derivatives.
%% the set $D = \enlargement{\mleft(\supp(I-A) \cup \supp(1-n)\mright)}$ is a bounded Lipshitz open set, where $\enlargement{S} = \set{\bx + \beps \in \RRd \st \bx \in S \tand \beps \in \RRd \twith \N{\beps}<1}.$ Therefore $\CzoD = \WoiD$, and hence $A \in \WoiDRRdtd$ and $n \in \WoiDRR.$ Outside $D$, $A=I$ and $n=1$, and thus $A \in \Woi{\RRd\setminus D;\RRdtd}$ and $n \in \Woi{\RRd\setminus D;\RR}$. As $A=I$ and $n=1$ on the boundary $\partial D,$ it follows that 
\ere

Our well-posedness results  require the scatterer $\Dm$ to be star-shaped, and our results for \cref{prob:tedp}  require the truncation domain $\Dtilde$ to be star-shaped with respect to a ball. We now recall these definitions.

  \bde[Star-shaped, star-shaped with respect to a ball]
  We say that $\Dm$ is star-shaped with respect to the point $\bxz$ if for all $\bx \in \Dm,$ the line segment $\mleft[\bxz,\bx\mright] \in \Dm.$

  We say that $\Dm$ is star-shaped with respect to the ball $B$ if $\Dm$ is star shaped with respect to $\bxz$, for all $\bxz \in B.$
  \ede

We can now state well-posedness results and a priori bounds for the Helmholtz equation in the class of heterogeneous media we have just defined.  We denote the ball of radius $R$ about the point $\bxz$ by $\Ball{R}{\bxz}.$ We denote $\Ball{R}{\bfzero}$ by $\BR.$



\bth[Well-posedness and bound for \cref{prob:edp}]\label{thm:edp}
If $\Dm, A, n,$ and $f$ satisfy the requirements in \cref{prob:edp}, $\gD = 0,$ $\Dm$ is star-shaped with respect to the origin, and there exists $\muo, \mut > 0$ such that $A \in \NTADp{\muo}$ and $n \in \NTnDp{\mut}$ then the solution of \cref{prob:edp} exists and is unique. Furthermore, given $R>0$ such that $\supp\mleft(I-A\mright),$ $\supp(1-n),$ and $\supp f$ are compactly contained in $\DR, = D \cap \BR$, then
\beqs
\muo \NLtDR{\grad u}^2 + \mut k^2 \NLtDR{u}^2 \leq \Co \NLtDR{f}^2,
\eeqs
for all $k>0,$ where
\beqs
\Co \de 4\mleft(\frac{R^2}{\muo} +\frac1{\mut}\mleft(R + \frac{d-1}{2k}\mright)^2\mright).
\eeqs
\enth

For the proof of \cref{thm:edp}, see \cite[Theorem 2.5]{GrPeSp:19}.

The following result is the analogue of \cref{thm:edp} for the solution of \cref{prob:tedp}. However, the statement is slightly more complicated than the statement of \cref{thm:edp} due to the presence of the impedance boundary $\GI$. In particular, we have additional data $\gI$ on $\GI$, and we bound the norm of $u$ on $\GI$ and well as on $D$.

\bth[Well-posedness and bound for \cref{prob:tedp}]\label{thm:tedp}
If $\Dm, A, n, f,$ and $\gI$ satisfy the requirements in \cref{prob:tedp}, $\gD = 0,$ $\Dm$ is star-shaped with respect to the origin, $\Dtilde$, is star-shaped with respect to a ball, and there exists $\muo, \mut > 0$ such that $A \in \NTAD{\muo}$ and $n \in \NTnD{\mut}$, then the solution of \cref{prob:tedp} exists and is unique. Let:
\bit
\item $\LI \de \max_{\bx \in \GI} \abs{\bx}$ and
\item $a\LI$ be the radius of the ball with respect to which $\Dtilde$ is star-shaped.
    \eit
Then
\begin{align}
  \muo \NLtD{\grad u}^2 + \mut k^2 \NLtD{u}^2 + a\LI\NLtGI{\gradGI \trGI u}^2& + 2\LI k^2 \NLtGI{\trGI u}^2\nonumber\\
&\quad\quad  \leq \Ct \NLtDR{f}^2 + \Cttilde \NLtGI{\gI}^2\label{eq:tedpbound}
\end{align}
for all $k>0,$ where $\gradGI$ is the surface gradient on $\GI,$
\beqs
\Ct \de 4\mleft(\frac{\LI^2}{\muo} + \frac1{\mut}\mleft(\beta + \frac{d-1}{2k}\mright)^2\mright),
\eeqs
\beqs
\Cttilde \de 2\mleft(2\mleft(1+\frac2a\mright) + \frac\beta{\LI} + \frac{\mleft(d-1\mright)^2}4\mright)\LI,
\eeqs
and
\beqs
\beta \de \LI \mleft(2+\frac1{\mleft(k\LI\mright)^2} + 2\mleft(1+\frac2a\mright)\mright).
\eeqs
\enth

For the proof of \cref{thm:tedp}, see \cite[Theorem A.6 (i)]{GrPeSp:19}.

Observe that the above results are stated only in the case that $\gD = 0$. Whilst there is no mathematical difficulty in proving analagous results in the case $\gD \neq 0,$ the calculations in this case are more involved, as one must consider the surface gradient on $\GD$  and this surface gradient depends on $A.$ In the case $A=I,$ these calculations are significantly simplified, and so in the case $A=I$ and $\gD \neq 0$ results analagous to \cref{thm:edp,thm:tedp} are proved in \cite[Theorem 2.19(ii)]{GrPeSp:19} (for \cref{prob:edp}) and \cite[Theorem A.6(iv)]{GrPeSp:19} (for \cref{prob:tedp}); although the proofs of these results require $\gD \in \HoGD.$

We highlight that \cref{thm:edp,thm:tedp} and the similar results in \cite{GrPeSp:19} are significant for the following two reasons.
\ben
\item These are the first $A,$ $n,$ and $k$-explicit bounds on the solution of the Helmholtz equation in the case where both $A$ and $n$ are heterogeneous. As will be discussed in more detail in \cref{sec:wpdisc} below, previous results were either not $A$, $n$, and $k$-explicit, or did not have $A$ \emph{and} $n$ varying. The $k$-explicitness of these results is crucial for understanding how the solution of the Helmholtz equation (and numerical methods for its approximation) behave for large $k$; the $A$-and-$n$-explicitness is crucial for proving bounds on the stochastic Helmholtz equation, as in \cref{chap:stochastic}, and for understanding how numerical methods are affected by the heterogeneity in $A$ and $n.$
  \item These are the first bounds explicit in $A$ and $n$ where the bound \emph{and} the restrictions on $A$ and $n$ are independent of $k.$ Previous results in the literature only proved such bounds by imposing conditions on $A$ and $n$ that became \emph{more stringent} as $k \rightarrow \infty;$ again, this literature will be more fully discussed in \cref{sec:wpdisc} below.
\een

\bre[Extensions of \cref{thm:edp,thm:tedp}]\label{rem:heteroextensions}
\Cref{thm:edp,thm:tedp} are extended to wider classes of heterogeneous $A$ and $n$ and to the case $\gD \neq 0$ in \cite{GrPeSp:19}. As stated above, the case $\gD \neq 0$ (with $A=I$) is treated in \cite[Theorem 2.19(ii)]{GrPeSp:19} (for \cref{prob:edp}) and \cite[Theorem A.6(iv)]{GrPeSp:19} (for \cref{prob:tedp}), and the case $n=1$ is covered in \cite[Theorem 2.19(i)]{GrPeSp:19} (for \cref{prob:edp}) and \cite[Theorem A.6(ii)]{GrPeSp:19}. We highlight that when either $A=I$ or $n=1$ (but not both) the condition on the non-constant coefficient can be slightly weakened from those in \cref{def:NT}. When $A$ and $n$ are discontinuous, \cite[Condition 2.6]{GrPeSp:19} gives analogues of the conditions in \cref{def:NT}, and then the result corresponding to \cref{thm:edp} is proved in \cite[Theorem 2.7]{GrPeSp:19}. Letting $A$ and $n$ be $L^\infty$-perturbations of nontrapping media is discussed in \cite[Remark 2.15]{GrPeSp:19}, and relaxing the Lipschitz assumption on $\GD$ is outlined in \cite[Remark 2.13]{GrPeSp:19}, with the caveat that when $\GD$ is non-Lipschitz, we instead formulate \cref{prob:edp} as a variational problem, which is discussed in \cref{sec:varform} below. The above extensions and generalisations can all be applied to \cref{prob:tedp}, as mentioned in \cite[p. 2916]{GrPeSp:19}.
\ere
\subsection{Discussion of results on well-posedness and a priori bounds for the Helmholtz equation}\label{sec:wpdisc}

We  now review the historical development of well-posedness results, and a priori bounds for the Helmholtz equation.

\subsubsection{Well-posedness results}
By `well-posedness', we mean that a solution of the problem under consideration exists, is unique, and continuously depends on the data ($f$, $\gD$, and $\gI$).

We note that proving well-posedness results and a priori bounds for the Helmholtz equation is much more involved than proving such results for the stationary diffusion equation
\beq\label{eq:stdiff}
\grad \cdot \mleft(A \grad u\mright) = -f \tin D.
\eeq
In \eqref{eq:stdiff} if $A$ is bounded above and bounded away from zero, then the associated bilinear form is bounded and coercive. Then the Lax--Milgram Theorem applies, and one immediately obtains well-posedness and an a priori bound (in $\HoD$) that is explicit in $A$.

However, for Helmholtz problems, the situation is much more subtle. Even if $A$ and $n$ are bounded above and bounded away from zero, in general one cannot prove a bound
\beq\label{eq:bgbound}
\NHokDp{u} \leq C \NLtDp{f},
\eeq
where $C$ depends explicitly on $A$, $n$, and the wavenumber $k$. A fundamental cause of this difficulty is the fact that the sesquilinear form $a$ associated with the standard variational formulation of the Helmholtz equation is not coercive. However, $a$ does satisfy a G\r{a}rding inequality
\beq\label{eq:gardingbrief}
\Re{a(v,v)} + k^2 \mleft(\Amin + \nmax\mright) \NLtD{v}^2 \geq \Amin \NHokD{v}^2,
\eeq
where
\beq\label{eq:weightednorm}
\NHokD{v} \de \mleft(\NLtD{\grad v} + k^2 \NLtD{v}\mright)^{1/2}
\eeq
is the weighted $H^1$ norm used frequently when studying Helmholtz problems\footnote{The norm $\NHokD{\cdot}$ is used because solutions of the Helmholtz equation typically  have $\grad u \sim ku$; therefore the norm $\NHokD{\cdot}$ should contain terms of roughly the same size. This relationship between the solution and its gradient is exactly the case for plane waves $u = \exp(ik \bx \cdot \bd)$ (for some $\bd \in \RRd$), where $\grad u = ik \bd u.$} The G\r{a}rding inequality means $\Re{a(v,v)}$ is `coercive' if an appropriate multiple of the $L^2$-norm is added to it.

Because of the G\r{a}rding inequality, if the solution of the Helmholtz equation is unique, then existence and an a priori bound on the solution follow from Fredholm Theory (see, e.g. \cite[Theorems 5.10 and 5.18]{Sp:15}; Fredholm theory can be applied because the sesquilinear form satisfies a G\r{a}rding inequality.) Therefore the challenge of proving well-posedness reduces to proving uniqueness. However, we note that the a priori bound one obtains using Fredholm theory is generally \emph{not} explicit in $k,$ $A$ or $n$.

For homogeneous problems (with $A=I$ and $n=1$) uniqueness follows from the Sommerfeld radiation condition (see, e.g., \cite[Corollary 2.9]{ChGrLaSp:12}); for heterogeneous problems, the Unique Continuation Principle (UCP) gives uniqueness, under some additional smoothness assumptions on $A$ and $n$ (see, e.g., \cite[p. 2871]{GrPeSp:19} for a discussion of the UCP and \cite[Section 2]{GrSa:18} for the application of the UCP to show uniqueness for heterogeneous Helmholtz problems). Therefore, as well-posedness results for the Helmholtz equation are essentially well-understood\footnote{Observe that if one can prove an a-priori bound of the form \eqref{eq:bgbound}, then one can conclude uniqueness (as the solution of the Helmholtz equation with zero data must therefore be the zero function). Therefore, if one can prove such a priori bounds \emph{without} the restrictions on $A$ and $n$ needed to apply the UCP, one can conclude uniqueness (and well-posedness, as outlined above) in a wider class of media; see \cite[pp. 2873, 2883]{GrPeSp:19} for more details on how the results in \cite{GrPeSp:19} can be used in this way.}, we now turn our attention to a priori bounds on the solution that are explicit in $k,$ $A$, and $n.$

\subsubsection{$k$-, $A$-, and $n$-explicit a priori bounds}
 All the bounds we now discuss will, unless otherwise stated, be for the weighted $H^1$ norm $\NHokD{\cdot}$ defined in \cref{eq:weightednorm}. We  only consider the case where the scatterer $\Dm$ is compact, and the inhomogeneities in $A$ and $n$ are compactly supported, as in \cref{prob:edp}. Research into so-called rough surface scattering, where either $\Dm$ or the inhomogeneities in $A$ and $n$ are not compactly supported, is itself a rich area of research (see, e.g., the literature reviews in \cite{Th:06}), but this area is not the concern of this thesis. Throughout this section we use $\lesssim$ notation--- we say $a \lesssim b$ if $a \leq C b,$ where $C$ is independent of $k$. We define $\gtrsim$ similarly, and say $a \sim b$ is $a \lesssim b$ and $a \gtrsim b.$

\def\techtitle{Techniques for proving a priori bounds}
\paragraph{\techtitle} There are two main classes of techniques for proving a priori bounds on the Helmholtz equation. The first class uses techniques from semiclassical analysis (a branch of microlocal analysis), and studies the behaviour of rays through the medium. For this approach to be used $\Dm,$ $A$, and $n$ must all be smooth, so that rays and the notion of reflections from the scatterer $\Dm$ can be defined (the notion of a reflection is difficult to define rigorously if the scatterer has a corner).

When one uses microlocal analysis tools, the key geometric condition on $A$, $n,$ and $\Dm$ is that of being nontrapping. The problem is \defn{nontrapping} if, for any bounded set $S \subseteq D$ there exists a time $t(S)$ such that any ray starting in $S$ and evolving according to the laws of geometrical optics leaves $S$ by time $t(S)$. The rigorous definition is more technical; see \cite[Section 6]{GrPeSp:19} for an overview. The problem is called \defn{trapping} if it is not nontrapping. Once one has proved the problem is nontrapping, one combines the paramatrix argument of Vainberg \cite{Va:75} with the propagation of singularities results of Melrose and Sj\"ostrand \cite{MeSj:82} to conclude a bound with the same $k$-dependence as \cref{thm:edp}.  Observe that trapping behaviour can be caused by an impenetrable obstacle (where, informally, rays `bounce' off the obstacle), a penetrable obstacle (where rays penetrate and are then `trapped' inside), or variations in the medium (that can also `trap' rays).


We see below that one can prove $k$-independent bounds even when rays cannot be defined, typically when $\Dm,$ $A$, and $n$ are not smooth. In such situations, one usually uses the mutiplier techniques discussed below. In an abuse of terminology, we call all situations where a bound holds with the same $k$-dependence as \cref{thm:edp} `nontrapping'.\label{pg:informalnontrapping}


The second class of techniques is multiplier techniques, where the PDE \eqref{eq:hhedp} is multiplied by carefully chosen multiples of, e.g.,  $u$ and $\bx\cdot\grad u$, and the resulting expression is then integrated by parts and rearranged. Whilst conceptually simpler than semiclassical analysis tools, multiplier methods allow one to prove bounds in situations that are inaccesible to semiclassical analysis, e.g., when the scatterer or coefficients are not smooth. However, multiplier techniques typically require more severe restrictions on the geometry of the scatterer (and truncation boundary, in the case of \cref{prob:tedp}) than semiclassical analysis techniques\footnote{One can choose more complicated multipliers to mitigate some of these restrictions, as in \cite{MoRaSt:77}, but most of the works we discuss below do not.}. Multiplier methods were first used for wave problems by Morawetz in the 1960s for studying  energy decay for the wave equation. See \cite{GaGrPaSaSoTa:18} for an overview of this, and other aspects of Morawetz's work and \cite[Theorem 1.1]{Vo:99} for the connection between energy decay for the wave equation and a priori bounds on the Helmholtz equation.

\paragraph{Situations in which to prove a priori bounds} We now summarise the state of the field regarding a priori bounds of the form \eqref{eq:bgbound}, and especially the dependence of the constant $C$ on $k,$ $A$, $n$, and $\Dm.$ Some of these results are proved in the context of energy decay results for the time-domain wave equation; for simplicity's sake, we do not distinguish in our comments between these results, and those proving bounds \eqref{eq:bgbound} directly. This section borrows heavily from the literature reviews in \cite[Section 1.1]{ChSpGiSm:17} and \cite[Sections 1 and 2.4]{GrPeSp:19}.

We note that trapping behaviour can be caused either by the obstacle (either an impenetrable obstacle $\Dm$ or a penetrable obstacle, modelled by a jump in $A$ and $n$) or by variations in the medium, defined by heterogeneous $A$ and $n$. For example, if an impenetrable obstacle $\Dm$ contains a cavity in which rays can be `trapped', see, e.g., \cref{fig:trapping}, then trapping occurs. Similarly, if $A$ and $n$ jump, modelling a penetrable obstacle, the jumps can cause rays to be trapped in a manner analagous to the concept of total internal reflection.

\begin{figure}
\centering
\begin{tikzpicture}[scale=2]
\input{trapping-figure}
\end{tikzpicture}
\caption{An example of an impenetrable obstacle with a cavity containing trapped rays.}\label{fig:trapping}
\end{figure}

%Typically, results in the literature either: (i) Assume the medium is constant, and focus on the behaviour of the wave induced by an impenetrable obstacle, or (ii) Assume there is no impenetrable obstacle (or there is a `nice' impenetrable obstacle that does not cause trapping behaviour) and consider the behaviour induced by penetrable obstacles and inhomogeneties in the medium, as both of these latter cases are modelled by heterogeneous $A$ and $n$.

This review will focus mainly on scattering induced by inhomogeneities in the medium, as this is the main concern of the results in \cref{thm:edp,thm:tedp} above (where the scatterer is assumed to be star-shaped). This is also the setting of the corresponding stochastic results in \cref{chap:stochastic}, where the medium is stochastic, and not the boundary of the scatterer. For an overview of results around impenetrable obstacle scattering, where $C$ can grow logarithmically, polynomially, or exponentially in $k$ depending on the scatterer, we refer the reader to the recent literature reviews in \cite[Sections 1.1 and 1.3]{ChSpGiSm:17}. %Also, we focus on bounds for both \cref{prob:edp,prob:tedp} at once; given \cref{prob:tedp} is a truncation of \cref{prob:edp} with a boundary condition chosen to mimic the radiation condition \cref{eq:src}, we expect similar behaviour for \cref{prob:tedp} as for \cref{prob:edp}.
% We recall that the best behaviour, obtained when the medium is nontrapping, is that the constant $C$ in \eqref{eq:bgbound} is independent of $k$ (possibly for some $k \geq \kz$).

\paragraph{The `worst case' a priori bounds} In the worst case, when $A$, $n$, and $\Dm$ are trapping, the constant $C$ can depend exponentially on $k$; i.e.,
\beq\label{eq:expbound}
C = \Co \exp(k\Ct),
\eeq
for some constants $\Co$ and $\Ct$ depending on $\Dm, $ $A$, and $n$. This worst case bound was proved for a general impenetrable obstacle and $A$ being $C^\infty$  (with $n=1$) by Burq \cite{Bu:98} and for a for penetrable obstacle (defined by $A$ and $n$, jumping across a shared $C^\infty$ interface) by  Bellasoued \cite{Be:03}. This worst case bound was proved for trapping by the medium when $A=$ and $n$ is a Lipschitz perturbation of $1$ by Shapiro \cite{Sh:18}.% Carleman estimates were used in \cite{Bu:98,Be:03}, and semiclassical analysis techniques in \cite{Sh:18}.

Moreover, the bound \eqref{eq:expbound} is sharp. This was shown to be sharp through a sequence of wavenumbers by Betcke, Chandler-Wilde, Graham, Langdon, and Lindner in \cite[Equation 2.22]{BeChGrLaLi:11}. For \cref{prob:edp} with constant media and an impenetrable scatterer whose boundary contains a certain part of an ellipse, they found a sequence $(\km)_{m \in \NN}$ (with corresponding solutions $\um$ and right-hand sides $\fm$ of \eqref{eq:hhedp}) such that 
\beqs
k\NLtDp{\um} \gtrsim \exp\mleft(\gamma \km\mright)\NLtDp{\fm},
\eeqs
for some $\gamma > 0$. Similarly, Popov and Vodev \cite{PoVo:99a} used semiclassical analysis techniques to prove the existence of a sequence $\km$ such that the growth in $\NLtDp{\um}$ is superalgebraic for a penetrable obstacle (given by $A=I$, and $n$ jumping downwards across a $C^\infty$ interface).

However, the recent works \cite{Ca:12,MoSp:19,LaSpWu:19} have shown that the exponential growth of $C$ \cref{eq:expbound} is realised at very few frequencies. Moiola and Spence \cite{MoSp:19} provided numerical evidence (for the transmission problem through a sphere) that the realisation of super-algebraic growth is very sensitive to the value of $k$. More rigorously, Capdeboscq \cite{Ca:12} obtained $k$-independent bounds for a penetrable circular obstacle in 2-d after excluding a small set of frequencies; and Lafontaine, Spence, and Wunsch \cite{LaSpWu:19} used microlocal analysis techniques to show that one can exclude a set of frequencies of arbitrarily small measure, and then obtain merely algebraic growth of $C$.


\paragraph{`Nontrapping' a priori bounds} In contrast to the results above, in the best case the constant $C$ in \cref{eq:bgbound} has the same $k$-dependence as in \cref{thm:edp}, i.e., $C \sim 1$ for all $k\geq \kz$. These `best case' results hold in a wide variety of settings, that we outline below, and in a slight abuse of terminology, we call all of these settings \defn{nontrapping}. This is a slight abuse of terminology as for nonsmooth $A$, $n$, and $\Dm$ we cannot always define `nontrapping' in the sense of rays given above. In what follows, unless otherwise specified, the boundary conditions on impenetrable obstacles are Dirichlet boundary conditions.

In the full-space problem (i.e., \cref{prob:edp}) when $A$, $n$, and $\Dm$ are smooth, bounds with $C \sim 1$ are proved with semiclassical analysis techniques by using (a) Melrose and Sj\"ostrand's results on propagation of singularities \cite{MeSj:82} combined with either (i) Vainberg's paramatrix argument from \cite{Va:75}, or (ii) Lax--Phillips theory \cite{LaPh:89} or (b) Burq's defect measure argument \cite{Bu:02}. An explicit value for $C$ is given in \cite{GaSpWu:18}.

For the full-space problem where $A$ and $n$ are not smooth, one typically uses multiplier techniques. These techniques were introduced by Morawetz and her collaborators in the 1960s and 1970s, who obtained bounds with $C \sim 1$ for a variety of obstacle types \cite{Mo:61,MoLu:68,Mo:75,MoRaSt:77} in constant media. Multiplier techniques were also used to prove bounds with $C \sim 1$ by Bloom and Kazarinoff \cite{Bl:73,BlKa:77} and Perthame and Vega \cite{PeVe:99} when $A$ or $n$ are not compactly supported and not $C^\infty$, but decay sufficently quickly at infinity, and posses sufficiently many derivatives for multiplier techniques to be used. Graham, the author of this thesis, and Spence also used multiplier techniques for a certain class of $A$ and $n$ possessing first-order derivatives (see \cref{thm:edp} and \cite{GrPeSp:19}. In general whilst multiplier techniques do not work over the full range of nontrapping obstacles\footnote{An exception is in \cite{Mo:75}, where the condition placed on the obstacle in \cite[Equation (1.3)]{Mo:75} is shown later in that paper (see \cite[Equation (1.3a)]{Mo:75}) to be equivalent to nontrapping in two dimensions.}, they allow one to conclude bounds when $A$, $n$, and $\Dm$ are less than $C^\infty.$

For the full-space problem where $A$ and $n$ jump (i.e. are discontinuous) it was proved that $C \sim 1$ for \cref{prob:edp} by Cardoso, Popov, and Vodev \cite{CaPoVo:99,PoVo:99b} using semiclassical analysis techniques when $A=I$ and $n$ jumps up across a strictly convex, smooth boundary; and by Moiola and Spence \cite{MoSp:19} using multiplier techniques when both $A$ and $n$ jump, under assumptions on the jumps. Also, \cref{thm:edp} and its related extensions discussed in \cref{rem:heteroextensions} prove $C \sim 1$ for \cref{prob:edp} in a variety of situations, including when $A$ and $n$ jump.


For the truncated problem, i.e., \cref{prob:tedp} or the IIP (\cref{prob:tedp} with $\Dm=\emptyset$) a bound with $C \sim 1$ is proved using semiclassical analysis techniques by Baskin, Spence, and Wunsch for the IIP with $A=I$ and $n=1$ \footnote{And these arguments can be generalised to certain classes of heterogeneous coefficients, see \cite[Remark 5.6]{BaSpWu:16}.} when $\GI$ is $C^\infty$ in \cite{BaSpWu:16}. Bounds for the case $A=I$ and $n=1$ (but with a scatterer $\Dm$ and/or less smoothness on $\GI$ were proved by Melenk \cite{Me:95}, Cummings and Feng \cite{CuFe:06}, and Hetmaniuk \cite{He:07}. Recently, similar bounds for the \defn{PML problem}, that is, \cref{prob:edp} truncated with a perfectly matched layer have been obtained by Li and Wu \cite{LiWu:19} (for no impenetrable obstacle) and Chaumont-Frelet, Gallistl, Nicaise, and Tomezyk (for a star-shaped impenetrable obstacle) \cite{ChGaNiTo:18}.

For the truncated problem with variable, possibly jumping, media, multiplier techniques have been used to prove bounds with $C \sim 1$ in a variety of recent work. Feng, Lin, and Lorton \cite{FeLiLo:15} proved a bound for random media (although the techniques in their proof are, in essence, for deterministic media), under the $k$-dependent assumption that $A=I$ and $n = 1 + \eta,$ with $\eta$ a random field and $\NLiD{\eta} \lesssim 1/k$ almost surely. Brown, Gallistl, and Peterseim proved a bound in \cite{BrGaPe:17}, under conditions related to, but more restrictive than, those in \cite{GrPeSp:19}. Barucq, Chaumont-Frelet and Gout \cite{BaChGo:17} proved a bound for 2-D piecewise-constant media, under a suitable condition on $n$. Graham and Sauter \cite{GrSa:18} took a very similar approach to \cite{GrPeSp:19}, proving a bound for heterogeneous media when $A=I$ under conditions on $n$ that are analogous to those in \cite{GrPeSp:19}. In related results, for the 1-dimensional Helmholtz equation in heterogeneous media, Chaumont-Frelet \cite[Section 2.1.5, Theorem 3]{Ch:15} used multiplier methods with specially-chosen test functions to show a bound for piecewise constant media, under assumptions on the media that limit the number of `pieces'. Sauter and Torres \cite{SaTo:18} used properties of the 1-dimensional Green's function to prove a bound for the 1-dimensional Helmholtz equation in piecewise-constant media with arbitrarily many `pieces', and with $C$ independent of $k$, but dependent on the number of pieces. Also, all of the results proved in \cite{GrPeSp:19} for \cref{prob:edp} have analogues for \cref{prob:tedp}.

Finally, we note that there is a small collection of work with $k$ growing polynomially in $k$. For the IIP with general Lipschitz boundary, Spence \cite{Sp:14} used bounds on layer potentials to show
\beqs
\NHokD{u} \lesssim k \NLtD{f} + k^{\half} \NLtGI{\gI},
\eeqs
building on work by Esterhazy and Melenk \cite{EsMe:12} and Feng and Sheen \cite{FeSh:94}. Ohlberger and Verf\"urth \cite{OhVe:18}, studied the case where $n=1$, $A$ is heterogeneous and scalar-valued and the heterogeneity is given by many small inclusions. They proved a bound with $C \sim k^3$ in this case. We suspect that both of these bounds are not sharp in their $k$-dependence, and that future work may improve the estimates of $C$ in these cases.

\bre[Bounds explicit in the parameters]
Bounds on the heterogeneous Helmholtz equation that are explicit in all parameters of interest (such as $k$, $A$, and $n$) are crucial for proving $k$-explicit bounds on the corresponding stochastic Helmholtz equation; such bounds on the stochastic Helmholtz equation are the subject of \cref{chap:stochastic}. We observe in passing that of the works we described above, the only ones that have bounds explicit in all the parameters of interest are those of Moiola and Spence \cite{MoSp:19}; Galkowski, Spence, and Wunsch \cite{GaSpWu:18}; and Graham, the author of this thesis, and Spence \cite{GrPeSp:19}.% We briefly highlight that the work of Galkowski, Spence, and Wunsch uses semiclassical analysis techniques to show, for nontrapping media, that $C$ depends on the length of the longest ray in the medium. However, calculating this length for a given $\Dm$, $A$, and $n$ is far from straightforward. In contrast, in \cite{MoSp:19,GrPeSp:19} $C$ depends on $A$ and $n$ in easily-calculatable ways (e.g., via $\max_{\bx \in \Dp} n(\bx)$).
\ere
