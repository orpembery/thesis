\section{Introduction}
This chapter has two main foci:
\ben
\item Theory for deterministic Helmholtz especially well-posedness and a priori bounds
\item Theory for FEM for deterministic Helmholtz especially error bounds
\een

Will include:
\bit
\item Discussion of well-posedness/bounds for Helmholtz incl. historical development - much more challenging than stationary diffusion
\item Background theory/setup for Helmholtz
\item Bounds/well-posedness results from \cite{GrPeSp:19}
\item Discussion of FE error bounds/Quasi-optimality etc. for Helmholtz incl. historical development
\item Background theory/setup for FEM
\item New contribution: Proofs of boundedness of error in heterogeneous case under mesh size $h \sim k^{-3/2}$
\eit

\section{Discussion of results on well-posedness and a priori bounds for the Helmholtz equation}
\bit
\item Will review history of well-posedness and a priori bounds for Helmholtz
\item Will contrast with stationary diffusion
\item To prepare for well-posedness and a priori bounds for stochastic Helmholtz in \cref{chap:stochastic}
\eit
Recall for stationary diffusion:
\bit
\item Variational formulation has bounded and coercive form
\item Lax--Milgram gives existence, uniqueness, a priori bound explicit in coeffs
\eit
Helmholtz:
\bit
\item Above approach doesn't work---not coercive for large $k$
\item But do have G\r{a}rding
\item So use Fredholm alternative to show existence and uniqueness equivalent
\item Show uniqueness via
\bit
\item UCP - but don't get a priori bound explicit in $k,$ parameters
\item Proving a priori bound explicit in $k$, parameters, but not always possible with current technology
\eit
\item A priori bounds major part of well-posedness
\item Also $k$- and parameter-explicit bounds needed for $k$- and $parameter$-explicit analysis of numerical methods
\item And to understand how medium affects wave propagation
\item A lot more subtle than stationary diffusion - there only quantities that enter are $\Amin$ and $\Amax$
\eit
\bit
\item Will now talk about bounds - not UCP as don't get explicit bound - see discussion in hetero
\item Focus on $k$-dependence (and later) parameter-dependence
\item Long history of proving bounds on Helmholtz from 'analysis' community \cite{Bl:73,Va:75,BlKa:77,Bu:98,PeVe:99,PoVo:99a,PoVo:99b,CaPoVo:99,Bu:02,Be:03,Ca:12,CaLePa:12,NgVo:12,Sh:17}\optodo{Check each and every reference}\optodo{Check about Morawetz} and recent interest from NA \cite{Me:95,CuFe:02,He:07,EsMe:12,Sp:14,FeLiLo:15,BaSpWu:16,Ch:16,BrGaPe:17,BaChGo:17,SaTo:17,OhVe:18,GrSa:18,GrPeSp:18,GaSpWu:18,MoSp:19}
\item Worst-case scenario - bounds grows exponentially in $k$
\bit
\item If everything $C^\infty$, shown for $n=1$ in \cite{Bu:02} and if $A=1$ and $n$ Lipschitz in \cite{Sh:17}. For both jumping across same $C^\infty$ interface in \cite{Be:02}.
\item Graham-Sauter \cite{GrSa:18} show exponential blow up in (properties of) coefficients, not $k$ in 1-D\ednote{Ivan, am I right with this comment?}
\item \cite{MoSp:19} - numerical evidence for super-algebraic growith with trapping jumps - proved in \cite{PoVo:99a,PoVo99b,CaPoVo:99}.
\eit
\item But only get exponential blow up when problem is trapping
\item Trapping if rays (angle of incidence = angle of reflection) stay for arbitrarily long time
\item Can get trapping if there are jumps in one direction, but not in other direction - \cite{MoSp:19}
\item Actually, trapping only happens at very few frequencies-\cite{MoSp:19,LaSpWu:19}
\item Related to idea of `resonant frequency'
\item Can be caused by obstacles or variations in speed - c.f. total internal reflection
\item If problem non-trapping (i.e. rays escape) then get bound independent of $k$ - see hetero\optodo{Find a reference for this}\optodo{iff?}
\item Therefore results proving $k$-indep bounds under some conditions can be seen as providing sufficient conditions for problem to be nontrapping.
\item Such results use either:
\bit
\item Multiplier techniques going back to Morawetz (and Rellich) \optodo{List results, demarcating homo and hetero} which give $k$-explicit bound directly, or
\item more technical microlocal/semi-classical\ednote{Euan, is there  any real difference between these?} tools, which give nontrapping, from which you can conclude bound\optodo{Find ref}
\item Recent work on bounds explicit in parameters---motivated in part by UQ - \cite{FeLiLo:15,GrPeSp:18,PeSp:18} prove bounds under conditions that ensure nontrapping, \cite{GaSpWu:18} assume problem is nontrapping and get `length of longest ray'.
\eit
\item In conclusion, subtle how things depend on $k,$ coefficients, and more difficult than stationary diffusion.
\eit

\section{Theory for the Helmholtz equation}
\ednote{Both - How much background do I assume on, e.g., Sobolev spaces? Do I assume it, put it in an Appendix, or put it here?}
First recap/state background theory on Helmholtz.
\bit
\item Define Helmholtz EDP/TEDP/IIP\optodo{Note to self, at this stage, but the weakest assumptions on the problem you need to define it}
\item Define variational formulation (for both zero and non-zero Dirichlet data)\ednote{Both - Would I need to prove the two formulations are equivalent (under sufficient regularity on $A$, etc.)? Or could I just quote the result from the hetero paper?}
\item Proof of $H^m$ regularity when $f$ etc. is smooth enough\optodo{See if I can just borrow from Serge and Theo}
\item G\r{a}rding inequality
\eit

\section{Well-posedness and bounds}
\bit
\item Now recap bounds/well-posedness results proved in hetero
\item Will be crucial for stochastic bounds in \cref{chap:stochastic}
\item Not the main focus of this thesis - only a joint author on hetero
\item Will give bounds that are:
\bit
\item $k$-independent
\item explicit in $A$ and $n$
\eit
\item Explicitness in $A$ and $n$ needed to prove stochastic bounds
\item As stated above, conditions we assume for proof are sufficient (but not necessary) for nontrapping.
\eit

\bit
\item Define $NT_A,$ $NT_n$ etc. ($n + \bx \cdot \grad n \geq \mu$ etc.)
\item Theorem: Bounds for EDP (with zero and non-zero Dirichlet data)
\item Theorem: Bounds for TEDP (with zero and non-zero Dirichlet data)
\item Result for non-zero Dirichlet data has $A=I$ to make things simpler, but could do for $A \neq I$
\item Why results are significant:
\bit
\item First $k$-explicit bounds where $A$ and $n$ both vary
\item First $k$-independent bounds explicit in $A$ and $n$
\item Enable analysis of stochastic problem - enables rigorous UQ
\eit
\item Can extend results to:
\bit
\item Discontinuous $A$ and $n$
\item $A$ and $n$ perturbations of $NT$
\eit
\eit

\section{Discussion of FEM for Helmholtz}
\bit
\item Now shift attention to NA of Helmholtz, specifically, FEM.
\item Recall from intro $h\sim k^{-1}$ (fixed ppw as num. points $\sim 1/h$) means interpolation error bounded
\bit
\item Can see by interpolation bounds from, e.g., Scott-Zhang (see below)
\item In 1-D\optodo{Find out if it works in higher D} motviate also by Shannon--Nyquist theorem
\item Both make precise intuition that we have bounded errors under fixed points per wavelength
\eit
\item Also recall Helmholtz suffers from pollution - fixed ppw not enough to keep FEM error bounded
\item This section will summarise conditions under which error bounded, and related property of quasi-optimality holds
\item Plan:
\bit
\item Introduce concepts of bounded error and quasi-optimality
\item Show (for contrast) that they are straightforward for stationary diffusion
\item Give overview of results on bounded error and Quasi-optimality for Helmholtz
\eit
\eit
\bit
\item Definition: error bounded
\item Would really like relative error bounded, however, not possible with current technology
\item Definition: Quasi-optimal
\item Natural question: what mesh size keeps error bounded?
\item Short history:
\bit
\item Bayliss, Goldstein, Turkel - computations showing $h\sim k^{-3/2}$ sufficient to keep error bounded
\item Ihlenburg, Babu\v{s}ka - prove error $\sim h^2k^3$ in 1-D if $h \sim k^{-1}$
\item Wu - error $\sim h^2k^3$ if $h \sim k^{-3/2}$ for 1st-order FEM
\item Du and Wu - error $\sim h^{2p}k^{2p+1}$ for higher-order FEM
\item Chaumont-Frelet \& Nicaise - similar result with corner singularities
\item Here in \cref{sec:errbound} first proof that $h\sim k^{-3/2}$ sufficient to keep relative error bounded in heterogeneous problems
\eit
\item For stationary diffusion, things are straightforward
\item Prove quasi optimality using C\'ea
\item Get FEM error bounded by using properties of interpolant, e.g., via Scott-Zhang.
\item No condition on $h$ needed, unlike Helmholtz
\item For Helmholtz Cea unavailable as not coercive
\item Proving Quasi-optimality more tricky
\item Instead use Aubin--Nitsche duality argument
\bit
\item Introduced by Nitsche\optodo{FOr what?}
\item Used by Aubin\optodo{For what}
\item Applied by Schatz to problems satisfying G\r{a}rding inequality
\item First applied to Helmholtz by Melenk
\item Obtain quasi-optimality under nontrapping assumptions and restrictive mesh condition $h \sim k^{-2}$---see \cite[Proposition 8.2.7]{Me:95} for homogeneous, \cite[Theorem 3]{GaSpWu:18} for heterogeneous, related bound in \cite[Section 1.4]{ChSpGiSm:17} sketched for parabolic trapping cases
\item Mesh condition is prohibitive for large $k$
\eit
\eit
Conclusion:
\bit
\item Rigorous NA of Helmholtz more demanding than, e.g., stationary diffusion
\item Mesh conditions require decreasing mesh size with $k$; esp. for quasi-optimality, very restrictive.
\eit
\section{Finite-element theory}
Now give requisite background finite-element theory
\bit
\item Definition - Finite element/Finite element space
\item Definition - Triangulation
\item Definition - Nodal Finite element
\item Definition - Mesh size
\item Definition - Fe space (of order $p$) associated with a triangulation
\item Definition - Scott--Zhang quasi-interpolant
\item Remark - Nodal interpolant falls within Scott--Zhang framework
\item Lemma - approximation properties of Scott--Zhang quasi-interpolant
\item Definition - Finite-element problem
\item Remark - won't be considering non-conforming error\optodo{At least understand this}
\item Lemma - Norm equivalence (Lemma 3.7 in current draft of nearby preconditioning article)
\eit

\section{Error bound for the heterogeneous IIP}\label{sec:backgroundbounds}
\bit
\item This section contains new work
\item Prove heterogeneous analogue of results on bounded error if $h \lesssim k^{-3/2}$
\item Proof technique uses `elliptic projection' idea - see Feng \& Wu, Wu, Du \& Wu, Chaumont-Frelet \& Nicaise.
\item Prove for IIP only, as need to use results on a related PDE from Chaumont-Frelet and Nicaise; only proved with impedance boundary condition - expect can extend to, e.g., exact DtN.
\item These bounds crucial for MLMC analysis in \cref{chap:mlmc}
\item Will prove for non-zero Dirichlet boundary condition, as motivation for MLMC is scattering
\eit
\section{Conclusion}
In this chapter:
\bit
\item Provided overview of bounds/well-posedness for Helmholtz
\bit
\item More complicatd than stationary diffusion
\item Depends on trapping/nontrapping
\item review historical and recent research efforts in this area; esp. heterogeneous/stochastic cases
\eit
\item Defined EDP/TEDP that we'll consider in this thesis
\item Proved result on regularity of solutions
\item Recapped in detail results from \cite{GrPeSp:19} on well-posedness and a priori bounds in particular case of nontrapping - crucial for our analysis of the stochastic problem.
\item Reviewed history of FEM NA for Helmholtz
\bit
\item Discussed $k$-dependence of mesh conditions
\item Had overview of historical development of results on quasi-optimality/bounded error
\item These mesh sizes are restricitive
\eit
\item Gave background theory for FEM for Helmholtz
\item Prove new results on error bounds for Helmholtz in heterogeneous media
\bit
\item Extend results in literature---only for homogeneous
\item Results crucial in analysis of numerical methods in subsequent chapters
\eit
Only new material that is the subject of this thesis is that in \cref{sec:backgroundbounds}
\eit
\optodo{Put size of linear systems in}
\optodo{Put in poor performance of GMRES?}
\optodo{Put in need for preconditioners?}