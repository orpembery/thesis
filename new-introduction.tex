\section{Introduction}\label{sec:intro}
The goals of this paper are to prove results on the well-posedness of variational formulations of the stochastic Helmholtz equation
\beq\label{eq:hh-intro}
\grad\cdot\mleft(A(\omega)\grad u(\omega)\mright) + k^2n(\omega)u(\omega) = -f(\omega),
\eeq
as well as a priori bounds on its solution that are explicit in the wavenumber $k$ and the material coefficients $A$ and $n.$


We consider \eqref{eq:hh-intro} with physical domain either $\RRd, \, d=2,3,$ or $\RR^d\setminus\Dmclos,$ where $\Dm$ (referred to as the \defn{obstacle}) is a bounded, Lipschitz, open set such that $\RRd\setminus\Dmclos$ is connected, and

\bit
\item $\omega$ is an element of the underlying probability space,
\item $A$ is a symmetric-positive-definite matrix-valued random field such that $\supp(I-A)$ is compact,
\item $n$ is a positive real-valued random field such that $\supp(1-n)$ is compact,
\item $f$ is a real-valued random field such that $\supp f$ is compact, and
  \item $k>0$ is the wavenumber,
  \eit
and we are particularly interested in the case where the wavenumber $k$ is large.

\paragraph{Motivation} The motivation for establishing well-posedness and proving a priori bounds on the solution of \eqref{eq:hh-intro} is the growing interest in Uncertainty Quantification (UQ) for the Helmholtz equation; see e.g.~\cite{XiSh:07,TsXiYi:11,BuGh:14,GaHa:15,FeLiLo:15,FeLiNi:18,LiWaZh:18,HiScScSc:15,BaCaHaZh:18}. (In this PDE context, by `UQ' we mean theory and algorithms for computing statistics of quantities of interest involving PDEs \emph{either} posed on a random domain \emph{or} having random coefficients.) There is a large literature on UQ for the stationary diffusion equation
\beq\label{eq:diffusion}
-\grad\cdot (\kappa(\omega) \grad u(\omega))=f(\omega),
\eeq
due in part to its large number of applications (e.g.~in modelling groundwater flow), and a priori bounds on the solution are vital for the rigorous analysis of UQ algorithms; see e.g.~\cite{BaTeZo:04,BaNoTe:07,Gi:10,MuSt:11,ChScTe:13}. In contrast, whilst \eqref{eq:hh-intro} has many applications (e.g.~in geophysics and electromagnetics), there is much less rigorous theory of UQ for the Helmholtz equation. The main reason for this is that the (deterministic) PDE theory of \eqref{eq:hh-intro} when $k$ is large is much more complicated that the analogous theory for \eqref{eq:diffusion}.
 
 \paragraph{Related previous work} To our knowledge, the only work that considers \eqref{eq:hh-intro} with large $k$ and attempts to establish either (i) well-posedness of variational formulations or (ii) a priori bounds is \cite{FeLiLo:15}, which considers both (i) and (ii) for \eqref{eq:hh-intro} posed in a bounded domain with an impedance boundary condition. We discuss the results of \cite{FeLiLo:15} further in \cref{sec:otherwork}, but we highlight here that (a) \cite{FeLiLo:15} considers $A=I$ and $n=1+\eta,$ with $\eta$ random and the magnitude of $\eta$ decreasing with $k,$  whereas we consider classes of $A$ and $n$ that allow $k$-independent random perturbations, and (b) in its well-posedness result, \cite{FeLiLo:15}  invokes Fredholm theory to conclude existence of a solution, but this relies on an incorrect assumption about compact inclusion of Bochner spaces---see \cref{sec:federico} below. In \cref{sec:otherwork} we also discuss the papers \cite{BuGh:14,JeSc:16,JeScZe:17,HiScScSc:15} on the theory of UQ for either \eqref{eq:hh-intro} or the related time-harmonic Maxwell's equations; in these papers either the $k$-explicit well-posedness is not a primary concern or $k$ is assumed to be small. Our hope is that the results in the present paper can be used in the rigorous theory of UQ for Helmholtz problems with large $k.$
 
\paragraph{The contributions of this paper} The main results in this paper, \cref{thm:hh-gen,thm:hh-hetero} below, concern well-posedness and a priori bounds for the solutions of various formulations of the stochastic Helmholtz equation; these formulations include those used in sampling-based UQ algorithms (\cref{prob:msedp,prob:somsedp} below) and in the stochastic Galerkin method (\cref{prob:svsedp} below). These are the first such results for arbitrarily large $k$ and for $A$ and $n$ varying independently of $k$. These results are proved by combining:
\ben
\item bounds for the Helmholtz equation in \cite{GrPeSp:19} with $A$ and $n$ deterministic but spatially-varying, with
\item general arguments (i.e.~not specific to Helmholtz) presented here for proving a priori bounds and well-posedness of variational formulations of linear elliptic SPDEs.
\een
Regarding 1: the $k$-dependence of the bounds on $u$ in terms of $f$ depends crucially on whether or not $A$, $n$, and $\Dm$ are such that there exist trapped rays. In the trapping case, the solution operator can grow exponentially in $k$ (see \cite{Ra:71,Bu:98,PoVo:99a,CaPo:02,Be:03} and \cite[Section 2.5]{BeChGrLaLi:11}, and the reviews in \cite[Section 6]{MoSp:19}, \cite[Section 1.1]{ChSpGiSm:17}, and \cite[Section 1]{GrPeSp:19}); in contrast, in the nontrapping case, the solution operator is bounded uniformly in $k$ (see \cite{Va:75,MeSj:78,Bu:02}). The bounds in \cite{GrPeSp:19} are under conditions on $A,n,$ and $\Dm$ that ensure nontrapping of rays; the significance of these bounds is that they are the first (deterministic) bounds for the Helmholtz scattering problem in which both $A$ and $n$ vary and the bounds are explicit in $A$ and $n$ (as well as in $k$). This feature of being explicit in $A$ and $n$ is crucial in allowing us to prove the results in this paper when $A$ and $n$ are random fields.

Regarding 2: the main reason these general arguments are needed is the fact that the variational formulations of both the deterministic and the stochastic Helmholtz equation are not coercive, and so one cannot use the Lax--Milgram theorem to conclude well-posedness and an a priori bound.  In the deterministic case, the remedy for the lack of coercivity of the Helmholtz equation is to use Fredholm theory, but this is \emph{not} applicable to the stochastic variational formulation of the Helmholtz equation because the necessary compactness results do not hold in Bochner spaces (see \cref{sec:federico} below). Our solution to this lack of coercivity and failure of Fredholm theory is to use well-posedness results and bounds from the deterministic case to prove results for the stochastic case. We work `pathwise' by integrating the deterministic results over probability space, identifying conditions under which the necessary quantities are indeed integrable. Our approach is given in a general framework that, given (i) deterministic well-posedness results and a priori bounds that are explicit in all the coefficients, and (ii) measurability and integrability conditions on the stochastic quantities, returns corresponding well-posedness results, a priori bounds, and equivalence results for different formulations of the stochastic problem. One reason we state our well-posedness results in general (i.e.~not only in the specific case of the Helmholtz equation) is that we expect that they can be used in the future to prove well-posedness results for the time-harmonic Maxwell's equations in random media. A nontechnical summary of the ideas behind our general well-posedness results is given in \cref{rem:nontechnical} below. Some of these results are similar in spirit to the results about the PDE \eqref{eq:diffusion} in \cite{Gi:10,MuSt:11} (which deal with the failure of Lax--Milgram for the stochastic variational problem for \eqref{eq:diffusion} in the case when the coefficient $\kappa$ is not uniformly bounded above and below), and our general arguments use some of the ideas and technical tools from these two papers. 
