We first recap a collection of results that will be needed for the error bounds that follow. All of these results are already available elsewhere, but we name the constants explicitly, so that what follows is, in principle, explicit in $k,$ $A$, and $n.$

We assume throughout this section that were are working with degree-$p$ finite elements, for some integer $p \geq 1.$ Also, we work with a general impedance boundary (satisfying certain assumptions, listed below) and so our domain is $D$ rather than $\DR$.

Throughout this section, we make the following additional \namecrefs{ass:highp}:
\bas[Assumptions for higher-$p$ FEM bounds]\label{ass:highp}
\bit
\item $k \geq 1$
\item $\Aij \in \CpmooDclos$
\item $\GD$ and $\GI$ are $\Cpo$
%\item $f \in \HpmoD$
%  \item $\gI \in \HpmhGI$
  \eit
\eas

Whilst the calculations in this \namecref{sec:fem} are explicit in all the constants involved, these dependencies are complex and, to a certain extent, unnecessary to understand the arguments. Therefore, the definition of all the constants (which are many-layered and interdependent) are relegated to \cref{app:constants}.

\subsection{Decomposition of solution and best approximation bound}

We first prove a best approximation bound in $\Vhp$ for the solution of the Helmholtz equation; following the presentation in \cite{ChNi:18a} (although we explicitly keep track of the constants involved at each point). In order to obtain bounds for higher $p$, we require the following shift \namecref{thm:shift}:

\bth[Shift theorem]\label{thm:shift}
Under \cref{ass:highp}, For all integers $l \in \mleft[0,p-1\mright]$ there exists a constant $\CAl>0$ (depending on $A$) such that, if $\ftilde \in \HlD$ and $\gItilde \in \HlphGI$, then there exists a unique $\utilde \in \HlptD$ such that $\utilde$ solves
\beqs
\grad \cdot \mleft(A \grad \utilde\mright) = -\ftilde,
\eeqs
\beqs
\dn \utilde = \gItilde,
\eeqs
and
\beqs
\trD \utilde = 0
\eeqs
and $\utilde$ satisfies the bound
\beq\label{eq:shift}
\NHlptD{\utilde} \leq \CAl \mleft(\NHlD{\ftilde} + \NHlphGI{\gItilde}\mright).
\eeq
\enth

\bpf[Proof of \cref{thm:shift}]
The uniqueness and existence of $\utilde$ (in $\HozDD$) follows from the Lax--Milgram theorem, as the variational formulation of is bounded and coercive. The proof for the higher regularity bounds uses standard elliptic regularity estimates in the interior, and near the boundaries $\GD$ and $\GI$, as a reference for these we use \cite[pp. 137-138]{Mc:00}; \cref{ass:highp} means we can apply these results.

To deal with the interior regularity and regularity near the boundary separately, we define the following subsets of $D$: $\Dint,\Dinttilde,\Dscat,$ and $\Dtrunc$\optodo{Put this in a picture - sketch is in Research 17, notes for 17th May} with the following properties:
\bit
\item $\Dint \compcont \Dinttilde \compcont D$,
\item $\GD \subset \Dscatclos$
\item $\dist(\Dscat,\GI) > 0 $
  \item $\GI \subset \Dtruncclos$
\item $\dist(\Dtrunc,\GD) > 0 $
    \eit
    First applying interior regularity \cite[Theorem 4.16]{Mc:00} in $\Dinttilde,$ we obtain the bound
    \beq\label{eq:shiftint}
\NHlptDint{\utilde} \leq \CintAl \mleft(\NHoDinttilde + \NHlDinttilde{\ftilde}\mright).
\eeq
Applying regularity up to the boundary for Dirichlet data \cite[Theorem 4.18 (i)]{Mc:00} in $\Dscat,$ we obtain (as $\trD \utilde = 0$)
\beq\label{eq:shiftscat}
\NHlptDscat{\utilde} \leq \CscatAl \mleft(\NHoD{\utilde} + \NHlD{\ftilde}\mright)
\eeq
and similarly\optodo{Spell checker} for Neumann data \cite[Theorem 4.18 (ii)]{Mc:00} in $\Dtrunc,$ we obtain
\beq\label{eq:shifttrunc}
\NHlptDtrunc{\utilde} \leq \CtruncAl \mleft(\NHoD{\utilde} + \NHlphGI{\dn \utilde} + \NHlD{\ftilde}\mright).
\eeq
Combining \cref{eq:shiftint,eq:shiftscat,eq:shifttrunc}, we obtain \cref{eq:shift}.
\epf

We make the following \namecref{ass:htwo} on the solution of \cref{prob:vtedp}, and adopt notation for an a priori bound on its solution:

\bas\label{ass:htwo}
\Cref{prob:vtedp} (or its adjoint) has a unique solution $u$ in $\HtD$, and there exists $\CAnk>0$ (possibly dependent on $A$, $n,$ and $k$) such that
\beq\label{eq:generalhtwo}
k \NLtD{u} + \SNHoD{u} + \frac1k \SNHtD{u} \leq \CAnk \Cfg,
\eeq
where $\Cfg \de \NLtD{f} + \NLtGI{\gI}$.
\eas
Note that one could require $\NHhGI{\gI}$ on the right-hand side of \cref{eq:generalhtwo} (as $\gI \in \HhGI$); however, since the bound in \cref{thm:tedp} only has $\NLtGI{\gI}$, we use the form \cref{eq:generalhtwo} to include \cref{thm:tedp}.

We are now able to prove the following theorem giving a decomposition of the solution $u$ of \cref{prob:vtedp} into lower-order, less oscillatory parts (meaning the power of $k$ in the a priori boudn is lower) and a smoother, more-oscilatory part. This result is essentially \cite[Theorem 1]{ChNi:18a}, in the particular case of a Helmholtz problem, but with the dependence on all the constants kept track of.

The following trace theorem is standard, see, e.g., \cite[Theorem 3.37]{Mc:00}.
\bth[Trace Theorem]\label{thm:trace}
If $v \in \HsD,$ for $1/2 < s \leq p+1$, then there exists $\CTrs > 0$ independent of $v$ such that
\beqs
\NHsmhGI{\trI v} \leq \CTrs \NHsD{v}.
\eeqs
\enth

We first have this simple \namecref{lem:domainshift}:

\ble\label{lem:domainshift}
Let $\ftilde \in \HlD$ and $\gtilde \in \HlpoD,$ for $0 \leq l \leq p-1$. If $\utilde \in \HlptD$ solves
\beqs
\grad \cdot \mleft(A\grad \utilde\mright) = -\ftilde,
\eeqs
\beqs \trGD u = 0,
\eeqs
and
\beqs
\dn u = i\gtilde,
\eeqs
then
\beqs
\NHlptD{\utilde} \leq \CAl\mleft(1+\CTrlpo\mright)\mleft(\NHlD{\ftilde} + \NHlpoD{\gtilde}\mright).
\eeqs
\ele
\bpf[Proof of \cref{lem:domainshift}]
By \cref{thm:shift,lem:domainshift}
\beqs
\NHlptD{\utilde} \leq \CAl \mleft(\NHlD{\ftilde} + \NHlphGI{\gtilde}\mright) \leq \CAl \mleft(\NHlD{\ftilde} + \CTrs\NHlpoD{\gtilde}\mright),
\eeqs
and the result follows.
\epf

We can now prove our expansion of the solution of \cref{prob:vtedp} or its adjoint.

\bth[Expansion of the solution of the Helmholtz equation]\label{thm:expansion}
Under \cref{ass:highp,ass:htwo} there exists $\uosc \in \HppoD$ and a sequence $\usj \in \HjptD,$ $j = 0,\ldots,p-2$ such that
\beq\label{eq:expansionuj}
\NHjptD{\usj} \leq \Pj(\NLiD{n}) k^j \Cfg, \text{ for }\Cj > 0,
\eeq
\beq\label{eq:expansionuosc}
\NHppoD{\uosc} \leq \Cosc k^p \Cfg, \text{ for some } \Cosc > 0,
\eeq
and
\beq\label{eq:expansionid}
u = \uosc + \sum_{j=0}^{p-2} \usj.
\eeq
Where the $\Pj(x)$
%=\sum_{m=0}^{j-2}\pfn{j,m}x^m $
are polynomials of degree
\beq\label{eq:polydegree}
\begin{dcases}
\frac{j}2 & \tif  j \text{ is even}\\
\frac{j-1}2 \tif j  \text{ is odd}.
\end{dcases}
\eeq
(except for $j=0,1,$ where $\Pj$ is a polynomial of degree 0) given by the recurrence relation
\beq\label{eq:pjdef}
\Pj(x) = \CAj \mleft(1+\CTrjpo\mright)\mleft(x\Pfn{j-2}(x) + \Pfn{j-1}(x)\mright).
\eeq
% No idea if this coefficient stuf is right
%% \begin{align}
%% \label{eq:p1}\pfn{0,0}&= \CAz\\
%% \label{eq:p2}\pfn{1,0}&  = \CAz\CAo\mleft(1+\CTrt\mright)\\
%% \label{eq:p3}\pfn{j,m} &=
%% \begin{dcases}
%%  0, &\tif m \leq \floor{\frac{j-2}2}\\
%% \CAj\mleft(1+\CTrjpo\mright) \mleft(\pfn{j-2,m-1} + \pfn{j-1,m-1}\mright),&\tif \floor{\frac{j-2}2} < m \leq j-3
%% \end{dcases}\\
%% \label{eq:p4}\pfn{j,j-2}& = \CAj\mleft(1+\CTrjpo\mright) \pfn{j-1,j-3},
%% \end{align}
and $\Cosc$ is given by the recurrence relations
\begin{align}
\label{eq:osc1}\Coscfn{1} &= \CAo\mleft(1+\CTrt\mright),\\
\label{eq:osc2}\Coscfn{2} &= \CAt\mleft(1+\CTrth\mright)\mleft(1 + \CAo\mleft(1+\CTrt\mright)\mright)\tand\\
\label{eq:osc3}\Coscfn{j} &= \CAfn{j}\mleft(1+\CTrfn{j+1}\mright)\mleft(\Coscfn{j-1} + \Coscfn{j-2}\mright),
\end{align}
and
\beq\label{eq:cosc}
\Cosc = \Coscfn{p-1}\CAnk.
\eeq

\enth

\bit
\item Powers of $k$ in non-oscillatory parts one smaller
\item Just copying Theo and Serge
\item Make contact with Melenk and Sauter
\item In principle exponential growth of constant with $p$
\eit

\bpf[Proof of \cref{thm:expansion}]
The idea of the proof is as follows. We write $u$ as a formal series expansion
\beq\label{eq:formalseries}
u = \sum_{j=0}^\infty \usj,
\eeq
and thens substitute this series into the PDE \cref{eq:tedp} and the boundary condition \eqref{eq:ibc}. Equating powers of $k$, we derive a recursive sequence of stationary diffusion equations for the functions $\usj,$ with right-hand sides dependent on $\ujmo$ and $\ujmt$. We use this recursive sequence and \cref{lem:domainshift} to prove the a priori bounds \cref{eq:expansionuj}. We then define the remainder from the $l$th partial sum, $\rl = u - \sum_{j=0}^{l-1} \usj,$ and by applying the operator $\grad\cdot\mleft(A\grad \cdot\mright)$ with Neumann boundary conditions to $\rl$, we obtain a recursive sequence for the remainders $\rl,$ and can similarly prove a priori bounds for the $\rl$s. The oscillatory function $\uosc$ is then just $\rpmo.$ The format of this proof is identical to that in \cite[Theorem 1]{ChNi:18a}, except we keep track of all of the constants involved.

For the purposes of the proof, it is more convenient to define $\vj = \usj/k^j,$ so that the series expansion \cref{eq:formalseries} becomes
\beq\label{eq:formalseriesv}
u = \sum_{j=0}^\infty k^j\vj.
\eeq
Also, in this proof, all the boundary-value problems involved included a zero Dirichlet condition on the scatterer $\GD;$ we omit this throughout the proof for brevity.

By applying the Helmholtz operator to the formal series \eqref{eq:formalseriesv} we obtain the following problems for $\vj \in \HjptD, j \geq 1$:
\beqs
\grad \cdot \mleft(A\grad \vz\mright) = -f \quad\tand\quad \dn \vz = \gI,
\eeqs
\beqs
\grad \cdot \mleft(A\grad \vo\mright) = 0\quad\tand\quad\dn \vo = i\vz,
\eeqs
and, for $j \in \mleft[2,p-2\mright]$
\beq\label{eq:vj}
\grad \cdot \mleft(A\grad \vj\mright) = - n\vjmt\quad\tand\quad\dn \vz = i\vjmo.
\eeq

By \cref{thm:shift} we immediately conclude the bound
\beq\label{eq:expuz}
\NHtD{\vz} \leq \CAz\Cfg,
\eeq
and by \cref{lem:domainshift,eq:expuz} we can conclude the bound
\beqs
\NHthD{\vo} \leq \CAo \mleft(1+\CTrt\mright)\NHtD{i\vz} \leq \CAz \CAo \mleft(1+\CTrt\mright)\Cfg.
\eeqs

We prove the bound \cref{eq:expansionuj} and the definition \cref{eq:pjdef} by induction; suppose they hold for all $s \in [0,j-1].$ Using \cref{lem:domainshift} and the definition of $\vj$ \cref{eq:vj}, we conclude that
\begin{align*}
\NHfn{j+2}{D}{\vj} &\leq \CAj \mleft(1+\CTrjpo\mright)\mleft(\NLiD{n} \NHfn{j}{D}{\vfn{j-2}} + \NHfn{j+1}{D}{\vfn{j-1}}\mright)\\
&\leq \CAj \mleft(1+\CTrjpo\mright)\mleft(\NLiD{n} \Pfn{j-2}\mleft(\NLiD{n}\mright) + \Pfn{j-1}\mleft(\NLiD{n}\mright)\mright)\Cfg.
\end{align*}
Therefore the definition of the polynomials $\Pj$ \cref{eq:pjdef} holds (and it is straightforward to see that $\deg\mleft(\Pj\mright) = \deg\mleft(\Pfn{j-2}\mright)+1$, where $\deg$ denotes polynomial degree, and therefore since $\deg\mleft(\Pfn{0}\mright) = \deg\mleft(\Pfn{1}\mright)=0,$ \cref{eq:polydegree} holds. Hence, by the relationship between $\usj$ and $\vj$, we have the bound \cref{eq:expansionuj}.

We will now similarly define the remainders $\rl$, and proceed similarly.
Let $\ro \in \HthD$ solve
\beqs
\grad \cdot \mleft(A\grad \ro\mright) = -k^2 u
\eeqs
\beqs
\dn \ro = iku.
\eeqs
Then by \cref{lem:domainshift}
\begin{align*}
\NHthD{\ro} &\leq \CAo\mleft(1+\CTrt\mright)\mleft(k^2\NHoD{u} + k\NHtD{u}\mright)\\
&\leq \CAo\mleft(1+\CTrt\mright)k^2\CAnk\Cfg.
\end{align*}
Let $\rt \in \HfD$ solve
\beqs
\grad \cdot \mleft(A\grad \rt\mright) = -k^2 u
\eeqs
\beqs
\dn \rt = ik\ro.
\eeqs
Then by \cref{lem:domainshift}
\begin{align*}
\NHfD{\rt} &\leq \CAt\mleft(1+\CTrth\mright)\mleft(k^2\NHtD{u} + k\NHthD{\ro}\mright)\\
&\leq \CAt\mleft(1+\CTrth\mright)\mleft(1 + \CAo\mleft(1+\CTrt\mright)\mright)\CAnk k^3\Cfg.
\end{align*}
Then for $j \geq 3,$ let $\rj \in \HjptD$ solve
\beqs
\grad \cdot \mleft(A\grad \rt\mright) = -k^2 \rjmt
\eeqs
\beqs
\dn \rj = ik\rjmo.
\eeqs
And by \cref{lem:domainshift} again, we have \cref{eq:osc1,eq:osc2,eq:osc3,eq:cosc}.
\epf
%\optodo{Just a note while I think about it - could you do DtN boundary conditions in this proof by testing with a different function when wanting to bound the $L^2$ norm on the boundary? I wonder if testing with the NtD of $u$ would mean you end up with a $\LtGI{u}^2$ term, and then you could use properties of the NtD map to bound other bits. Might foil $k$-dependency though.}
Using the expansion in \cref{thm:expansion}, we can prove the following error bound for the best approximation of $u$ in $\Vhp$:

%% We also have the following best-approximation error in higer-order Sobolev spaces:
%% \ble[Best approximation in $\HsD$]\label{lem:bestapproxhigh}
%% For integer $s$ in $[1,p+1]$, there exists $\Cinterps>0$ such that for every $v \in \HsD$ there exists $\vhhat \in \Vhp$ such that
%% \beqs
%% \NLtD{v - \vhhat} + h\NHoD{v-\vhhat} \leq \Cinterps h^s \SNHsD{v}.
%% \eeqs
%% \ele

\ble[Best approximation error bound]\label{lem:bestapprox}
Under \cref{ass:highp,ass:htwo}, There exist constants $\CFEMo, \CFEMt > 0$ and independent of $k$ (although dependent on $A$ and $n$) such that if $u$ solves \cref{prob:vtedp} or its adjoint, then there exists $\uhhat \in \Vhp$ such that
\beq\label{eq:bestapproxL2}
\NLtD{u-\uhhat} \leq \mleft(\CFEMo h^2 + \CFEMt \CAnk h\mleft(hk\mright)^p \mright)\Cfg,
\eeq
\beq\label{eq:bestapproxH1}
\NHoD{u-\uhhat} \leq \mleft(\CFEMo h + \CFEMt \CAnk \mleft(hk\mright)^p \mright)\Cfg \tand
\eeq
\beq\label{eq:bestapproxW}
\NW{u-\uhhat} \leq 2\mleft(\CFEMo h + \CFEMt \CAnk \mleft(hk\mright)^p \mright)\Cfg.
\eeq
The constants are given by
\beq\label{eq:CFEMs}
\CFEMo = \sum_{j=0}^{p-2}\Cinterpfn{j+2} \Pj\mleft(\NLiD{n}\mright) \tand \CFEMt = \Cinterpfn{p+1}\Cosc
\eeq
\ele

We write bounds for the standard and weighted $H^1$ norms separately, as we will use each individual bound in differents of proofs in \cref{sec:fembound}.

\bpf[Proof of \cref{lem:bestapprox}]
We apply \cref{lem:scottzhang} to all the $\usj$ and $\uosc$ in \cref{thm:expansion}, and obtain that there exists $\vjh,$ $j=0,\ldots,p-2$ and $\vosch$ in $\Vhp$ such that 
\beqs
\NLtD{\usj - \vjh} + h\NHoD{\usj - \vjh} \leq \Cinterpfn{j+2} \Pj\mleft(\NLiD{n}\mright) h^{j+2}k^j \Cfg
\eeqs
and
\beqs
\NLtD{\uosc - \vosch} + h\NHoD{\uosc - \vosch} \leq \Cinterpfn{p+1} \Cosc\CAnk h^{p+1}k^p \Cfg.
\eeqs
Therefore, by letting $\uhhat = \vosch + \sum_{j=0}^{p-2} \vjh,$ we have (using the fact that $hk \leq 1$) \cref{eq:bestapproxL2,eq:bestapproxW}, with $\CFEMo$ and $\CFEMt$ as given by \cref{eq:CFEMs}.
\epf

\subsection{Error bounds for simple Galerkin projections}\label{sec:errgalerkin}
In this \namecref{sec:errgalerkin} we state a sequence of error bounds for various projections, in various norms. The proofs of these error bounds are all simple modifications of the proofs of \cite[Theorem 5.8.3]{BrSc:08}\ednote{Both-should I write out at least one of these modified proofs?}. % Note to self, I have these proofs sketched out, but just use the argument from Brenner and Scott and use an L^2 inner product on the function, not their gradients, for the elliptic projection.
We first define the projections we use.

Define the elliptic projection $\Ph:\HozDD\rightarrow\Vhp$ by, for $w \in \HozDD$
\beqs
\IPLtD{A\grad\vh}{\grad\Ph w} = \IPLtD{A\grad\vh}{\grad w} \tforall \vh \in \Vhp
\eeqs
Observe that $\Ph$ is simply the finite-element solution of a stationary diffusion problem, with a particular right-hand side in $\HozDD'.$
The elliptic projection obeys the following error bounds:
\ble[Error bounds for elliptic projection]\label{lem:ellprojerr}
For any integer $s \in [-1,p-1],$ there exists a constant $\Cmso >0$ such that for all $w \in \HozDD$
\beq\label{eq:ellprojerr}
\NHmsD{w-\Ph w} \leq \Cmso h^{s+1} \BAHoD{w}{\wh},
\eeq
where
\beqs
\Cmso = \frac{\NLiDop{A}^2}{\Amin}\CSZs.
\eeqs
\ele

We define the $\LtD$ projection $\Qh:\HozDD\rightarrow \Vhp$ by, for $w \in \HozDD$
\beqs
\IPLtD{\Qh w}{\vh} = \IPLtD{w}{\vh} \tforall \vh \in \Vhp.
\eeqs
The $\LtD$ projection satisfies the following error bound:
\ble[Error bounds for $\LtD$ projection]\label{lem:ltdprojerr}
For any integer $s \in [0,p-1],$ there exists a constant $\Cmsz >0$ such that for all $w \in \LtD$
\beqs
\NHmsD{w-\Qh w} \leq \Cmsz h^{s} \BALtD{w}{\wh}.
\eeqs
\ele

We also need to define the $\LtD$ projection in a norm weighted by $n$

For $v,w \in \LtD,$ define the $n$-weighted inner product
\beqs
\IPLtDn{v}{w} = \int_{D} n v \wbar,
\eeqs
and the corresponding $n$-weighted $\LtD$ norm
\beqs
\NLtDn{v} = \sqrt{\int_{D} n \abs{v}^2}.
\eeqs
The $n$-weighted $\HsD$ norms, for $s \in \ZZ$, are defined as normal, but replacing the appearance of an $\LtD$ norm by its weighted version, and in the definition of $n$-weighted norms for negative $s,$ replacing the appearance of the $L^2$ inner product by its $n$-weighted version.

Define the $\LtD$ projection in the $n$-weighted norm $\Qhn:\HozDD\rightarrow \Vhp$ by, for $w \in \HozDD$
\beqs
\IPLtDn{\Qh w}{\vh} = \IPLtDn{w}{\vh} \tforall \vh \in \Vhp.
\eeqs
The $n$-weighted $\LtD$ projection satisfies the following error bound:
\ble[Error bounds for weighted $\LtD$ projection]\label{lem:wltdprojerr}
For any integer $s \in [0,p-1],$ there exists a constant $\Cnmsz >0$ such that for all $w \in \HozDD$
\beq\label{eq:wltdprojerr}
\NHmsnD{w-\Qhn w} \leq \Cnmsz h^{s} \BALtDn{w}{\wh},
\eeq
where
\beqs
\Cnmsz = \frac{\NLiD{n} }{\nmin}\CSZs.
\eeqs
\ele

\subsection{Discrete Sobolev spaces}\label{sec:discsob}
In order to perform our analysis for high-order FEM, we will need to measure higher-order norms of functions in the finite-element space $\Vhp.$ However, as these functions do not have higher-order weak derivates, we must first develop some theory of so-called discrete Sobolev spaces; we follow the presentation in \cite{DuWu:15}, albeit working in the heterogeneous case, and with some changes of notation.

We let $\DeltaAI:\LtD\rightarrow\HtD$ denote the solution operator for the stationary diffusion equation: given $\ftilde \in \LtD$ find $\utilde \in \HtD$ such that
\beq\label{eq:sdeq}
\grad \cdot \mleft(A\grad \utilde\mright) = -\ftilde
\eeq
\beq\label{eq:sddbc}
\trD \utilde = 0
\eeq
\beq\label{eq:sdnbc}
\dn \utilde = 0.
\eeq


%% $A$-weighted Laplacian; that is $\DeltaA w = \grad\cdot\mleft(\grad w\mright),$ and give it domain $\DomainDeltaA = \set{w \in \HtD \st \trD w = 0, \dn w = 0};$
%% hence $\DeltaA:\DomainDeltaA \rightarrow \LtD.$ Observe that, for any $f \in \LtD$ there exists $\wf \in \DomainDeltaA$ such that $\DeltaA \wf = -f.$
Observe that $\sdres$ is well-defined by \cref{lem:domainshift}. Also, observe that $\sdres^{m}$ is defined for any $m \in \NN,$ as $\HtD \subseteq \LtD.$
Observe that for any $\ftilde \in \LtD$ and for any $v \in \HozDD,$ we have, by Green's identity,
\beq\label{eq:deltaagreen}
\int_D \mleft(A \grad \mleft(\DeltaAI(\ftilde)\mright)\mright)\cdot \grad \vb = \int_D \ftilde \vb
\eeq

\bde[Discrete derivative operator]
Define the \defn{$A$-weighted discrete second derivative operator} $\Deltah:\Vhp\rightarrow\Vhp$ for $\wh \in \Vhp$ by
\beq\label{eq:discderdef}
\IPLtD{\Deltah \wh}{\vh} = \IPLtD{A \grad \wh}{\grad \vh} \tforall \vh \in \Vhp.
\eeq
\ede

\ble[Discrete derivative operator is well-defined]\label{lem:ddwd}
For any $\wh \in \Vhp,$ $\Deltah \wh$ exists and is unique.
\ele

\bpf[Proof of \cref{lem:ddwd}]
If one chooses an orthonormal basis $\phij$ for $\Vhp,$ writes $\Delta\wh = \sum_j \wj \phij$, and takes $\vh = \phij$ for each $j,$ then \cref{eq:discderdef} becomes the linear system $\Imat \bw = \bb,$ where $\bb_{j} = \IPLtD{A \grad \wh}{\grad \phij}.$ The solution of this linear system clearly exists and is unique.
%% We equip $\Vhp$ with the $H^1$-norm. Observe that $\Deltah \wh$ satisfies the variational problem: Find $\vhtilde  \in \Vhp$ such that $\add(\uh,\vh) = \Ldd(\vh)$ for all $\vh \in \Vhp,$ where $\add(\uh,\vh) = \IPLtD{\uh}{\vh}$ and $\Ldd(\vh) = \IPLtD{A \grad \wh}{\grad \vh}.$ Observe that $\Ldd$ is bounded in $\Vhp$, as $\Ldd(\vh) \leq \NLiDop{A} \SNHoD{\wh}\SNHoD{\vh} \leq \NLiDop{A} \SNHoD{\wh}\NHoD{\vh},$ and $\add$ is coercive on $\Vhp,$ as, for $\vh \in \Vhp$, $\add(\vh,\vh) = \NLtD{\vh}^2 \geq \CinvVhp^2 \NHoD{\vh}^2$ by the standard inverse estimate\optodo{Add in?}. Therefore, by the Lax--Milgram Theorem applied in $\Vhp$ (as $\Vhp$ is a finite-dimensional inner product space over a complete field, it is a Hilbert space), $\Deltah \wh$ exists and is unique.
\epf

%% By\optodo{McLean Thm 4.12 - double check and maybe write out in more detail---exactly what operator are we talking about, especially if we want weak derivatives?}, there exists a sequence of eigenfunctions $\phio,\phit,\ldots \in \HoD$ of $\DeltaA$\optodo{What exactly does McLean mean here, if they don't have second-order derivatives?} and corresponding eigenvalues $0 < \lambdao<\lambdat < \cdots \rightarrow\infty$ such that the eigenfunctions form a complete orthonormal system in $\LtD.$\optodo{Maybe define this}

Since $A(\bx)$ is symmetric, it is almost-everywhere self-adjoint. Hence it follows that $\Deltah$ is self-adjoint, as
\beqs
\IPLtD{\Deltah \wh}{\vh} = \IPLtD{A \grad \wh}{\grad \vh} = \IPLtD{\grad \wh}{A\grad \vh} = \overline{\IPLtD{\Deltah \vh}{\wh}} = \IPLtD{\wh}{\Deltah \vh}.
\eeqs
Therefore $\Deltah$ is diagonalisable, i.e., there exists a set of eigenfunctions $\phioh,\ldots,\phidimVhph$  with corresponding eigenvalues $\lambdaoh, \ldots, \lambdadimVhph$ such that the $\phimh$ form an orthonormal basis of $\Vhp$ (orthonormal in the $\LtD$-norm).

\bde[Higher-order discrete derivative operators]
For $\vh \in \Vhp$, if $\vh = \sum_{m=1}^{\dimVhp} \am \phimh,$ then for $j \in \RR$ define
\beqs
\Deltah^j \vh = \sum_{m=1}^{\dimVhp} \lambdamh^j \am \phimh.
\eeqs

%% Similarly, for $v \in \LtD,$ if $v = \sum_{m=1}^\infty \am \phim,$ then for $j \in \RR$ define
%% \beq\label{eq:deltaaseries}
%% \DeltaA^j v = \sum_{m=1}^\infty \lambdam^j \am \phim,
%% \eeq
%% if this series exists in $\LtD.$
\ede

%We let $\Domain{\DeltaA^j}$ denote the subset of $\LtD$ on which $\DeltaA^j$ is defined.

%% \bre[Negative powers of $\DeltaA$]
%% Observe that for \emph{every} $j \leq 0$, $\DeltaA^j v$ is defined for \emph{any} $v \in \LtD$ (i.e., $\Domain{\DeltaA^{j}} = \LtD$ for $j \leq 0$). For $\lambdam \geq 1,$ $\lambdam^j < \lambdam$, and only finitely many $\lambdam$ are in the interval $(0,1)$; therefore the series \cref{eq:deltaaseries} can be decomposed as a finite sum (for $\lambdam < 1$) and a convergent series (for $\lambdam \geq 1$).
%% \ere

%% \bre[Consistent Notation]
%% Observe that the notation $\DeltaA^j$ is consistent, i.e., $\DeltaA^0 v = v$, for $j \in \NN,$ $\DeltaA^j$ is equal to the $j$-fold application of $\DeltaA,$ and $\DeltaA^{-1}$ is the inverse of $\DeltaA.$\optodo{Maybe just double-check this is watertight.}\optodo{This needs work - need $A$ to be smooth enough to define proper higher-order derivatives.}
%% \ere

We can use the higher-order derivative operators to define higher-order norms:

%% \bde[$A$-weighted higher-order continuous norm]
%% For $v \in \LtD$ and $m \in \RR$, if $\DeltaA^{m/2} v$ exists, define
%% \beqs
%% \NmA{v} = \NLtD{\DeltaA^{m/2} v}.
%% \eeqs
%% \ede

%% In order to prove a relationship between the $A$-weighted higher order norm and the standard $H^m$ norms, we first must prove the following \namecref{lem:normrelationshiptech}\optodo{THIS NEEDS PROVING AND I DON'T KNOW HOW.}
%% \ble[Relationship between $\DeltaA^m$ and standard higher-order derivatives]\label{lem:normrelationshiptech}
%% For $m \in \NN,$ $\Domain{\DeltaA^{m/2}} \subseteq \HmD,$ and there exists a constant $\Cma > 0$ such that for all $v \in \Domain{\DeltaA^{m}}$
%% \beqs
%% \NHmD{v} \leq \Cma \NLtD{\DeltaA^{m/2}v}.
%% \eeqs\optodo{The latter bit will probably use something shift-theorem-like, but you need to be careful because powers of the differential operator aren't defined standardly.}
%% \ele


%% \ble[Relationship between $A$-weighted and standard higher-order continuous norms]\label{lem:normrelationship}
%% For all $m \in \NNz,$ for all $v \in \HmmD,$
%% \beqs
%% \NHmmD{v} \geq \frac1{\Cma} \NmmA{v}.
%% \eeqs
%% \ele

%% \bpf[Proof of \cref{lem:normrelationship}]
%% For $v \in \HmmD,$ we have
%% \begin{align*}
%% \NHmmD{v} &= \sup_{w \in \HmD} \frac{\IPLtD{v}{w}}{\NHmD{w}}\\
%% &\geq \frac1{\Cma} \sup_{w \in \Domain{\DeltaA^{m/2}}} \frac{\IPLtD{v}{w}}{\NmA{w}} \text{ by \cref{lem:normrelationshiptech}}\\
%% & = \frac1{\Cma} \sup_{w \in \Domain{\DeltaA^{m/2}}} \frac{\IPLtD{\DeltaA^{-m/2}v}{\DeltaA^{m/2}w}}{\NmA{w}} \text{ by \cref{lem:intoip}}\\
%% &= \frac1{\Cma} \NmmA{v} \text{ the supremum is achieved when } \IPLtD{\DeltaA^{-m/2}v,\DeltaA^{m/2}w} = \NLtD{\DeltaA^{-m/2}v}\NLtD{\DeltaA^{m/2}w}
%% \end{align*}
%% \epf

\ble[Introduction of derivatives into inner product]\label{lem:intoip}
%% For $m \in \RR,$ $v \in \LtD$, and $w \in \LtD\cap\Domain{\DeltaA^{m/2}}$ we have
%% \beqs
%% \IPLtD{\DeltaAmmt v}{\DeltaAmt w} = \IPLtD{v}{w}.
%% \eeqs
%% Similarly, f
For $\vh, \wh \in \Vhp,$ we have
\beq\label{eq:feipsplit}
\IPLtD{\Deltahmmt \vh}{\Deltahmt \wh} = \IPLtD{\vh}{\wh}
\eeq
and
\beq\label{eq:feiptrans}
\IPLtD{\Deltahmt \vh}{\Deltahmt \vh} =  \IPLtD{\Deltah^m \vh}{\vh},
\eeq
and similarly for the $n$-weighted $\LtD$ inner product.
\ele
\bpf[Proof of \cref{lem:intoip}]
We only prove \cref{eq:feipsplit}, as the proofs of \cref{eq:feiptrans} and the $n$-weighted variants are analagous. Since $\vh,\wh \in \Vhp,$ there exist sequences $(\aj)_{j =1,\ldots,\dimVhp}$ and $(\bsl)_{l j =1,\ldots,\dimVhp}$ such that $\vh = \sum_{j=1}^{\dimVhp} \aj\phij$ and $\wh = \sum_{l=1}^{\dimVhp} \bsl \phil.$ Then we have
\begin{align*}
\IPLtD{\Deltahmmt \vh}{\Deltahmt \wh} &= \int_D \mleft(\sum_{j=1}^{\dimVhp}\lambdaj^{-m/2} \aj\phij\mright)\overline{\mleft(\sum_{l=1}^{\dimVhp} \lambdal^{m/2}\bsl \phil\mright)}\\
&= \sum_{j,l=1}^{\dimVhp} \lambdaj^{-m/2} \lambdal^{m/2} \aj \bsl \int_D \phij \philbar\\
& =\sum_{j}^{\dimVhp} \aj \bsj \int_D \abs{\phij}^2 \text{ as the } \phij \text{ are orthonormal}\\
&= \IPLtD{\vh}{\wh} \text{ by repeating the above process in reverse, without the factors } \lambdaj^{-m/2} \tand \lambdal^{m/2}.
\end{align*}
\epf

The following \namecref{cor:ipdiscbound} follows from \cref{lem:intoip} and the Cauchy--Schwarz inequality.

\bco[Inner product bounded by discrete norms]\label{cor:ipdiscbound}
If $vh, \wh \in \Vhp,$ then for all $j \in \RR$
\beqs
\IPLtD{\vh}{\wh} \leq \Njh{\vh}\Nmjh{\wh}.
\eeqs
\eco

We recall the standard inverse inequality for finite-element functions.

\ble[Standard inverse inequality]\label{lem:inverseinequality}
There exists $\CinvVhp > 0$ such that for all $\vh \in \Vhp$
\beqs
\NHoD{\vh} \leq \CinvVhp h^{-1} \NLtD{\vh}.
\eeqs
\ele

We can now prove an analagous inverse inequality for discrete norms.

\ble[Inverse inequality for discrete norms]\label{lem:inversediscrete}
For all $j \in \ZZ$, for all $\vh \in \Vhp$
\beqs
\Njh{\vh} \leq \Chinv h^{-1} \Njmoh{\vh},
\eeqs
where
\beqs
\Chinv = \CinvVhp \NLiDop{A}^{1/2}.
\eeqs
\ele

\bpf[Proof of \cref{lem:inversediscrete}]
by the definition of $\Njh{\cdot}$, and the fact that $\Deltah^{j/2} = \Deltah^{1/2}\Deltah^{(j-1)/2},$ it suffices to prove the result for $j=1$. We have
\begin{align*}
\Noh{\vh}^2 &= \IPLtD{\Deltahh \vh}{\Deltahh \vh}\\
&= \IPLtD{\Deltah \vh}{\vh} \text{ by \cref{eq:feiptrans}}\\
&= \IPLtD{A \grad \vh}{\grad \vh} \text{ by definition of } \Deltah\\
&\leq \NLiDop{A} \CinvVhp h^{-2} \NLtD{\vh} \text{ by the standard inverse estimate}\\
&= \NLiDop{A} \CinvVhp h^{-2} \Nzh{\vh} \text{ as } \Nzh{\cdot} = \NLtD{\cdot},
\end{align*}
and the result follows.
\epf

\ble[Relationship between standard and discrete $H^1$ norms]\label{lem:h1contdisc}
Let $\vh \in \Vhp$. Then
\beqs
\SNHoD{\vh} \leq \Amin^{\half} \Noh{\vh}.
\eeqs
\ele

\bpf[Proof of \cref{lem:h1contdisc}]
We have
\begin{align*}
\Noh{\vh}^2 &= \IPLtD{\Deltahh \vh}{\Deltahh \vh}\\
&= \IPLtD{\Deltah \vh}{\vh} \text{ by \cref{eq:feiptrans}}\\
&= \IPLtD{A \grad \vh}{\grad \vh}\\
&\geq \Amin \NLtD{\grad \vh}^2,
\end{align*}
and the result follows.
\epf

The following \namecref{lem:negdiscsum} will require the following \namecref{lem:shiftnegative} giving the shift theorem in negative norms.
\ble[Shift theorem in negative norms]\label{lem:shiftnegative}
For $m \in \NN,$ and $\ftilde \in \LtD,$ we have
\beqs
\NHmmD{\DeltaAI\mleft(\ftilde\mright)} \leq \CAm \NHmmmtD{\ftilde}.
\eeqs
\ele

\bpf[Proof of \cref{lem:shiftnegative}]
Throughout the proof we let $\utilde$ denote $\DeltaAI\mleft(\ftilde\mright).$ As $\ftilde \in \LtD,$ it follows that $\utilde \in \HtD$ by \cref{thm:shift}, and so in particular $\utilde \in \HmmD.$ We can then compute
\begin{align*}
\NHmmD{\utilde} &= \sup_{0 \neq \vtilde \in \HmD} \frac{\IPLtD{\utilde}{\vtilde}}{\NHmD{\vtilde}}\\
&= \sup_{0 \neq \vtilde \in \HmD} \frac{\IPLtD{\ftilde}{\DeltaAI\vtilde}}{\NHmD{\vtilde}}\text{ as } \DeltaAI \text{ is self-adjoint}\\
&\leq \sup_{0 \neq \vtilde \in \HmD} \frac{\NHmmmtD{\ftilde}\NHmptD{\DeltaAI\vtilde}}{\NHmD{\vtilde}} \text{ by \cref{thm:shift} } \DeltaAI\vtilde \in \HmptD\\
&\leq \sup_{0 \neq \vtilde \in \HmD} \frac{\NHmmmtD{\ftilde}\CAm\NHmD{\vtilde}}{\NHmD{\vtilde}} \text{ by \cref{thm:shift}}\\
&= \CAm \NHmmmtD{\ftilde}
\end{align*}
as required. The fact that $\sdres$ is self-adjoint follows from the fact that the boundary-value problem \cref{eq:sdeq,eq:sddbc,eq:sdnbc} is self-adjoint\ednote{Both - do I need to show this? It's straightforward.}.% Note to self, have (Rv,w), where R is resolvent, for v in L^2, w in H^m. Have PR = Id (but not necessarily the other way round) so w = PRw. Then (Rv,w) = (Rv,PRw) = (PRv,Rw) (P self-adjoint) = (v,Rw). Denote differential operator (on the correct space) by P.
\epf

We can now prove the following \namecref{lem:negdiscsum} on the relationship between the negative-order discrete norms and the negative-order continuous norms.
\ble[Relationship between discrete and continuous negative-order norms]\label{lem:negdiscsum}
For any integer $j \in [0,p+1],$ there exists a constant $\Csumj > 0$ such that for all $\vh \in \Vhp,$
\beqs
\Nmjh{\vh} \leq \Csumj \sum_{m=0}^j h^{m-j} \NHmmD{\vh}.
\eeqs
\ele

\bpf[Proof of \cref{lem:negdiscsum}]
Let $\wh \in \Vhp,$ and define $\zh = \DeltahI \wh,$ $z = \DeltaAI \wh$ (observe $z$ is well-defined as $\Vhp \subseteq \LtD$). Then, for all $\yh \in \Vhp \subseteq \HozDD$, we have
\begin{align*}
\IPLtD{\wh}{\yh} &= \IPLtD{A \grad z}{\grad \yh} = \IPLtD{\grad z}{A\grad \yh} = \overline{\IPLtD{A\grad \yh}{\grad z}} \\
\IPLtD{\wh}{\yh} &= \IPLtD{A \grad \zh}{\grad \yh} = \IPLtD{\grad \zh}{A\grad \yh} = \overline{\IPLtD{A\grad \yh}{\grad \zh}}
\end{align*}
where the first equalities in each line follow from \cref{eq:deltaagreen,eq:discderdef}, respectively, and the second inequalities in each line follow from the fact that $A$ is symmetric. That is, for all $\yh \in \Vhp,$ $\IPLtD{A\grad \yh}{\grad z} = \IPLtD{A\grad \yh}{\grad \zh},$ i.e., $\zh = \Ph z.$

We now have, for $m \in [-1,p-1]$
\begin{align}
\NHmmD{\DeltahI \wh} &\leq \NHmmD{z} + \NHmmD{z-\zh}\nonumber\\
&\leq \NHmmD{z} + \Cmmo h^{m+1} \Cinterpt h \SNHtD{z} \text{ by \cref{lem:ellprojerr,lem:scottzhang}}\nonumber\\
&\leq \NHmmD{z} + \Cmmo \Cinterpt \CAt h^{m+2} \NLtD{\wh} \text{ by \cref{thm:shift}}\nonumber\\
&\leq \CAm \NHmmmtD{\wh} + \Cmmo \Cinterpt \CAt h^{m+2} \NLtD{\wh} \text{ by \cref{lem:shiftnegative}}\nonumber\\
&= \CAm \NHmmmtD{\wh} + \Cm h^{m+2} \NLtD{\wh}\label{eq:sumforrecursion}
\end{align}
where $\Cm \de \Cmmo \Cinterpt \CAt.$

Immediate from \cref{eq:sumforrecursion}, we can conclude that, for $l \in \NN$ and $\wh \in \Vhp$ (as $\Deltahml = \DeltahI \Deltahmlpo$)
\beq\label{eq:lrecursion}
\NHmmD{\Deltahml \vh} \leq \CAm \NHmmmtD{\Deltahmlpo \vh} + \Cm h^{m+2} \NLtD{\Deltahmlpo \vh}.
\eeq
We now use \cref{eq:lrecursion} recursively to bound $\Nmjh{\vh}$:
If $j = 2l,$ then one can show inductively using \cref{eq:lrecursion} that for any integer $t \in [0,l-1]$ that
\beq\label{eq:evenrecursivesum}
\Nfn{-2l,h}{\vh} \leq \sum_{m=0}^t h^{2m} \NHDfn{-2(t-m)}{\Deltah^{-l+t} \vh} \Efn{m,t},
\eeq
where the $\Efn{m,t}$ are defined inductively by
\begin{align}
\label{eq:Emt1}\Efn{0,0} &= 1 \tif m=t=0\\
\label{eq:Emt2}\Efn{m,t+1} &= \CAfn{2(t-m)} \Efn{m,t} \tfor 0 \leq m \leq t \tand\\
\label{eq:Emt3}\Efn{t+1,t+1} &= \sum_{m=0}^t \Cfn{2(t-m)} \Efn{m,t}.
\end{align}

If $j=2l+1,$ then we reduce to a point analagous to the even case, and then proceed as before. Let $\wh$ and $\zh$ be as at the beginning of the proof, and let $z$ solve the variational formulation\footnote{We use the variational formulation here, as we will need to bound the $H^1$-norm of $z$ by the $H^{-1}$-norm of $\wh$.}  of \cref{eq:sdeq,eq:sddbc,eq:sdnbc} (with $\ftilde = \wh$). Observe that $\NHoD{z} \leq \NHmoD{\wh}/\Amin$ by the Lax--Milgram Theorem. We have
\begin{align}
\NLtD{\Deltah^{-1/2}\wh} &= \NLtD{\Deltah^{1/2} \zh}\nonumber\\
&= \Noh{\zh}^2\nonumber\\
&= \IPLtD{\Deltah \zh}{\zh}\\
&= \IPLtD{A \grad \zh}{\grad zh}\nonumber\\
&\leq \NLiDop{A} \SNHoD{\zh}\nonumber\\
&\leq \NLiDop{A} \NHoD{\zh}\nonumber\\
&= \NLiDop{A} \NHoD{\Ph z}\nonumber\\
&\leq \NLiDop{A}\mleft(\NHoD{z} + \NHoD{\Ph z - z}\mright)\nonumber\\
&\leq \NLiDop{A}\mleft(\NHoD{z} + \NHoD{0 - z}\mright) \text{ by \cref{lem:ellprojerr}}\nonumber\\
&= 2\NLiDop{A}\NHoD{\DeltaAI \wh}\nonumber\\
&\leq \frac2{\Amin} \NLiDop{A} \NHmoD{\wh}\label{eq:deltahhalf}
\end{align}
We now return to $\Nmjh{\vh} = \NLtD{\Deltah^{-l-1/2} \vh} = \NLtD{\Deltah^{-1/2} \Deltah^{-l} \vh} \leq 2/\Amin \NLiDop{A} \NHmoD{\Deltah^{-l} \vh}$ by \cref{eq:deltahhalf}.

Similarly to \cref{eq:evenrecursivesum}, one can show that, for integers $t \in [0,l]$
\beqs
\NHmmD{\Deltah^{-l}} \leq \Etildefn{t,t} \NHDfn{-2t-1}{\Deltah^{-1+t}\vh} + \sum_{m=0}^t h^{2(t-m)+1} \Etildefn{m,y} \NHDfn{-2m}{\Deltah^{-l+t}},
\eeqs
where  the $\Etildefn{m,t}$ are given, for $t \in [0,l-1]$ by
\begin{align}
\label{eq:Etilde1}\Etildefn{0,0} &= 1\\
\label{eq:Etilde2}\Etildefn{0,t+1} &= \Etildefn{t,t}\Cfn{2t+1} + \sum_{m=0}^{t-1} \Etildefn{m,t}\Cfn{2m},\\
\label{eq:Etilde3}\Etildefn{m,t+1} &= \Etildefn{m-1,t}\CAfn{2(m-1)}.\tfor m = 1,\ldots,t\\
\label{eq:Etilde4}\Etildefn{t+1,t+1} &= \Etildefn{t,t}\CAfn{2t+1},\tand
\end{align}
Therefore, letting $\Csumj = \max\set{\Efn{m,l},2\NLiDop{A}\Etildefn{m,l}/\Amin \st m \in \set{0,\ldots,l}},$ the result follows.%\optodo{Maybe put recursion in, but it's all in notes.}
\epf

\subsection{Main finite-element-error bound}\label{sec:fembound}

Having established the need results on discrete Sobolev spaces, we are now in a position to prove our main theorem, \cref{thm:fembound} below, which we do via a series of lemmas.

\bth[Higher-order error bound for the heterogeneous Helmholtz equation]\label{thm:fembound}
Let $u$ be the solution of \cref{prob:vtedp}. Under \cref{ass:highp,ass:htwo}, if $hk \leq 1,$ and if there exists $Ctildemin > 0$ independent of $k$ such that $\CAnk k \geq \Ctildemin,$ then there exist constants $\CFEMLt, \CFEMHo, \Chcond > 0$, independent of $h$ and $k$ such that if
\beq\label{eq:hfemcond}
h \leq \Chcond k^{-1-\frac1{2p}} \CAnk^{-\frac1{2p}},
\eeq
then the finite-element solution $\uh$ exists, is unique, and satisfies the error bounds
\beq\label{eq:femltbound}
\NLtD{u-\uh} \leq \CFEMLt \mleft(h \CAnk (hk)^{p}\mright)\inf_{\vh \in \Vhp} \NW{u-\vh}, \tand
\eeq
\beq
\NW{u-\uh} \leq \CFEMHo \mleft(1 + \CAnk k(kh)^p\mright) \inf_{\vh \in \Vhp} \NW{u-\vh},
\eeq\label{eq:femhobound}
where $\CFEMLt$, $\CFEMHo,$ and $\Chcond$ are given in \cref{app:constants}.
\enth

Two quantiies that are of utmost importance to the proof are
\beqs
\rho \de u - \Ph u, \tand
\eeqs
\beqs
\thetah \de \Ph u - \uh.
\eeqs
The main idea of the proof is to decompose the error $u - \uh = \rho + \thetah,$ use bounds on the elliptic projection operator to bound $\rho,$ and the bound $\thetah$ (in higher-order discrete norms) in terms of $\rho.$

The following simple \namecref{lem:simpleform} sets up the argument in the lemmas that follow.
\optodo{Either just put the assumptions of the main theorem everywhere, or work through which ones are actually needed at each point. Not sure what to do....}
\ble[Expression for $a(\thetah,\vh)$]\label{lem:simpleform}
For any $\vh \in \Vhp,$
\beq\label{eq:thetaform}
a(\thetah,\vh) = k^2\IPLtDn{\Qhn\rho}{\vh} + ik \IPLtGI{\rho}{\vh}.
\eeq
\ele

\bpf[Proof of \cref{lem:simpleform}]
Let $\vh \in \Vhp.$ Then $a(\thetah,\vh) = a(u-\uh,\vh) - a(\rho,\vh) = -a(\rho,\vh)$ by Galerkin orthogonality. By definition of $a,$ we have $-a(\rho,\vh) = -\IPLtD{A\grad\mleft(u-\Ph u\mright)}{\vh} + k^2 \IPLtD{n\mleft(u-\Ph u\mright)}{\vh} + ik\IPLtGI{u-\Ph u}{\vh}.$ By definition of the elliptic projection $\Ph$, $\IPLtD{A\grad\mleft(u-\Ph u\mright)}{\vh} = 0$, and so by the definition of the $n$-weighted $L^2$ inner product, and the $n$-weighted $L^2$-projection $\Qhn,$ the result follows.
\epf

\ble[Bound on $\NLtGI{\thetah}$ by $\Npmoh{\thetah}$]\label{lem:boundarybound}
\beq\label{eq:boundarybound}
\NLtGI{\thetah}^2 \leq \Cboundaryo \NLiD{n}^4 k^2 h^{2p-1} \Nfn{p-1,h}{\thetah}^2 + \Cboundaryt h \NW{\rho}^2,
\eeq
where $\Cboundaryo = 2\Cmess^2$ and $\Cboundaryt = \mleft(1 + \CMT^2 \Cfn{0,1}\mright)/2.$
\ele

\bpf[Proof of \cref{lem:boundarybound}]
In \cref{eq:thetaform}, let $\vh = \thetah,$ and take the imaginary part to obtain
\beqs
-k \NLtGI{\thetah}^2 \leq \Im k^2 \IPLtDn{\Qhn \rho}{\thetah} + \Re k \IPLtGI{\rho}{\thetah},
\eeqs
and therefore by \cref{lem:intoip}
\beq\label{eq:thetaboundarypart}
\NLtGI{\thetah}^2 \leq  k \Nfn{1-p,h,n}{\Qhn \rho}\Nfn{p-1,h,n}{\thetah} + \NLtGI{\rho}\NLtGI{\thetah}\leq  k \NLiD{n}^2 \Nfn{1-p,h}{\Qhn \rho}\Nfn{p-1,h}{\thetah} + \NLtGI{\rho}\NLtGI{\thetah}.
\eeq
In order to bound the negative norm $\Nfn{1-p,h}{\Qhn\rho},$ we use \cref{lem:negdiscsum}; this use means we need to estimate negative Sobolev norms of $\Qhn\rho$; for integers $m \in [0,p-1]$ we have
\begin{align}
\NHmmD{\Qhn\rho} &\leq \NHmmD{\Qhn u - u} + \NHmmD{u - \Ph u}\nonumber\\
&\leq \Cfn{n,-m,z} h^m \NLtD{u-\Ph u} + \Cmmo h^{m+1} \NHoD{u - \Ph u}\\
&\quad\quad\text{ by \cref{lem:ellprojerr,lem:wltdprojerr}, taking } \wh = \Ph u \text{ in \cref{eq:ellprojerr,eq:wltdprojerr}}\nonumber\\
&\leq \mleft(\Cfn{n,-m,0} \Cfn{0,1} + \Cfn{-m,1}\mright) h^{m+1} \NW{\rho} \text{ by \cref{lem:ellprojerr}}\label{eq:Qhnrhoneg}
\end{align}
By \cref{lem:negdiscsum} we have
\beq\label{eq:Qhnrhosum}
\Nfn{1-p,h}{\Qhn \rho} \leq \Cmess h^p \NW{\rho},
\eeq
where $\Cmess \de \Csumpmo \mleft(\sum_{m=0}^{p-1} \Cfn{-n,m,0} \Cfn{0,1} + \Cfn{-m,1}\mright).$ To deal with the second term on the right-hand side of \cref{eq:thetaboundarypart} we use \cref{thm:multiplicativetrace,lem:ellprojerr}, taking $\wh = \Ph u$ in \cref{eq:ellprojerr} and the fact that $\NHoD{\cdot} \leq \NW{\cdot}$ to obtain
\beq\label{eq:rhomtbound}
\NLtGI{\rho} \leq \CMT \Cfn{0,1}^{\half} h^{\half} \NW{\rho}.
\eeq
Using \cref{eq:rhomtbound} and Young's inequality, we therefore obtain
\beq\label{eq:rhothetamt}
\NLtGI{\rho}\NLtGI{\thetah} \leq \half \CMT^2 \Cfn{0,1} h \NW{\rho}^2 + \half \NLtGI{\thetah}^2.
\eeq
By combining \cref{eq:rhothetamt,eq:Qhnrhosum,eq:thetaboundarypart}
\beq\label{eq:thetahboundnear}
\NLtGI{\thetah}^2 \leq k \Cmess h^p \NLiD{n}^2\NW{\rho} \Nfn{p-1,h}{\thetah} + \half \CMT^2 \Cfn{0,1} h\NW{\rho}^2 + \half \NLtGI{\thetah}^2.
\eeq
By using Young's inequality on the first term in \cref{eq:thetahboundnear}, and moving the $\NLtGI{\thetah}^2$ terms onto the left-hand side, we obtain \cref{eq:boundarybound}.
\epf

\ble[Bound on higher-order discrete norms of $\thetah$ by $\NLtD{\thetah}$]\label{lem:higherbound}
For $m \in [1,p]$ there exist constants $\Chighmo,$ $\Chighmt > 0$ such that
\beq\label{eq:chigh}
\Nmh{\thetah} \leq \Chighmo k^m \NLtD{\thetah} + \Chighmt h^{1-m} \NW{\rho}.
\eeq
\ele

\bpf[Proof of \cref{lem:higherbound}]
By inserting the definition of $\Deltah$ in \cref{eq:thetaform} and rearranging, for any $\vh \in \Vhp$ we have
\beqs
\IPLtD{\Deltah \thetah}{\vh} = k^2 \IPLtDn{\thetah}{\vh} + k^2\IPLtD{\Qhn \rho}{\vh} + ik \IPLtGI{\thetah}{\vh} + ik \IPLtGI{\rho}{\vh}.
\eeqs
Therefore, if we take $\vh = \Deltah^{m-1}\thetah,$, by \cref{lem:intoip} we have
\beq\label{eq:deltahm}
\Nmh{\thetah}^2 = k^2 \Nfn{m-1,h,n}{\thetah}^2 + k^2 \IPLtDn{\Deltah^{\frac{m-1}2} \Qhn \rho}{\Deltah^{\frac{m-1}2}\thetah} + ik\IPLtGI{\thetah}{\Deltah^{m-1} \thetah} + ik \IPLtGI{\rho}{\Deltah^{m-1} \thetah}.
\eeq
We now proceed to bound the two terms in \cref{eq:deltahm} defined on the truncation boundary $\GI.$ For the first term, we have
\begin{align}
\IPLtGI{\thetah}{\Deltah^{m-1}\thetah} &\leq \NLtGI{\thetah}\NLtGI{\Deltah^{m-1}\thetah}\nonumber\\
&\leq \CMT \CinvVhp \NLtGI{\thetah} h^{-\half} \NLtD{\Deltah^{m-1} \thetah}\\
&\quad\quad\text{ by \cref{thm:multiplicativetrace,lem:inverseinequality}.}\nonumber\\
&= \CMT \CinvVhp h^{-\half}\NLtGI{\thetah}\Nfn{2m-2,h}{\thetah}\nonumber\\
&\leq \CMT \CinvVhp \Chinv^{m-1} h^{-m+\half} \NLtGI{\thetah}\Nfn{m-1,h}{\thetah} \text{ by \cref{lem:inversediscrete}}\nonumber\\
&\leq \CMT \CinvVhp \Chinv^{m-1}  \mleft(\Cboundaryo^{\half} \NLiD{n}^2 k h^{p-m} \Nfn{p-1,h}{\thetah} + \Cboundaryt^{\half} h^{1-m} \NW{\rho}\mright)\Nfn{m-1,h}{\thetah}\\
&\quad\quad\text{ by \cref{lem:boundarybound} and \cref{eq:simple}}\nonumber\\
&\leq \mleft(\CBo k \Nfn{m-1,h}{\thetah} + \CBt h^{1-m} \NW{\rho}\mright)\Nfn{m-1,h}{\thetah} \text{ by \cref{lem:inversediscrete},},\label{eq:firstboundary}
\end{align}
where
\beqs
\CBo = \CMT \CinvVhp \Chinv^{m-1} \Cboundaryo^{\half} \NLiD{n}^2\Chinv^{p-m},\tand
\eeqs
\beqs
\CBt = \CMT \CinvVhp \Chinv^{m-1} \Cboundaryt^{\half}.
\eeqs

To bound the second boundary term in \cref{eq:deltahm}, we have
\beq\label{eq:secondboundarytemp}
\IPLtGI{\rho}{\Deltah^{m-1} \thetah} \leq \CMT \CinvVhp \Chinv^{m-1}\Nfn{m-1,h}{\thetah}\NLtGI{\rho}
\eeq
using \cref{thm:multiplicativetrace,lem:inverseinequality} as above. By \cref{thm:multiplicativetrace,lem:ellprojerr} (with $\wh = \Ph u$) we have
\beq\label{eq:secondboundarytemp2}
\NLtGI{\rho} \leq \CMT \Cfn{0,1}^{\half} h^{\half} \NW{\rho}.
\eeq
Inseting \cref{eq:secondboundarytemp2} into \cref{eq:secondboundarytemp} we obtain
\beq\label{eq:secondboundary}
\IPLtD{\rho}{\Deltah^{m-1}\thetah} \leq \CBth h^{1-m} \NW{\rho} \Nfn{m-1,h}{\thetah},
\eeq
where $\CBth = \CMT^2 \CinvVhp \Chinv^{m-1}\Cfn{0,1}^{\half}.$

Therefore, from \cref{eq:deltahm,eq:firstboundary,eq:secondboundary}, using Young's inequality and \cref{eq:simple}, we have
\begin{align}\label{eq:thetahighnearly}
\Nfn{m,h}{\thetah} &\sqrt{\frac32 \NLiD{n}^2 + \CBo + \half} k  \Nfn{m-1,h}{\thetah} + \frac{\NLiD{n}}{\sqrt{2}} k \Nfn{m-1,h}{\Qhn \rho} + \frac{\mleft(\CBt + \CBth\mright)}{\sqrt{2}} h^{1-m} \NW{\rho}.
\end{align}
We now proceed to bound $\Nfn{m-1,h}{\Qhn \rho}$: By \cref{lem:inversediscrete} and the fact that $\Qhn \Ph u = \Ph u$ (as $\Ph u \in \Vhp$), we have
\beq\label{eq:qhnmmo}
\Nfn{m-1,h}{\Qhn \rho} \leq \Chinv^{m-1} h^{1-m} \mleft(\NLtD{\Qhn u - u} + \NLtD{u-\Ph u}\mright).
\eeq
We can bound the first of these two terms by the second: $\NLtD{\Qhn u - u} \leq \NLtDn{\Qhn u - u}/\nmin \leq \Cfn{n,0,0}/\nmin \NLtDn{u - \Ph u} \leq \NLiD{n}/\nmin \Cfn{n,0,0} \NLtD{u-\Ph u}$, using \cref{lem:wltdprojerr} and properties of the $n$-weighted $L^2$ norm. We can also bound the second term by \cref{lem:ellprojerr}: $\NLtD{u - \Ph u} \leq \Cfn{0,1} h \NW{\rho}.$ Therefore by \cref{eq:qhnmmo} we have (as $kh \leq 1$)
\beq\label{eq:qhnnearly}
k \Nfn{m-1,h}{\Qhn \rho} \leq \Chinv^{m-1} \mleft(\frac{\NLiD{n}}{\nmin} \Cfn{n,0,0} + 1\mright) \Cfn{0,1} h^{1-m} \NW{\rho}.
\eeq
Therefore using \cref{eq:thetahighnearly,eq:qhnnearly} we have
\beq\label{eq:readytorecurse}
\Nfn{m,h}{\thetah} \leq \CReco k \Nfn{m-1,h}{\thetah} + \CRect h^{1-m} \NW{\rho},
\eeq
where
\beqs
\CReco = \sqrt{\frac32 \NLiD{n}^2 + \CBo + 1/2} \tand \CRect = \frac{\NLiD{n}}{\sqrt{2}} \Chinv^{m-1} \mleft(\frac{\NLiD{n}}{\nmin} \Cfn{n,0,0} + 1\mright)\Cfn{0,1}.
\eeqs
Using \cref{eq:readytorecurse} and the fact that $hk \leq 1,$ we obtain \cref{eq:chigh}, with $\Chighmo = \CReco^m$ and $\Chighmt = \sum_{j=0}^{m-1} \CReco^j \CRect.$
\epf

\ble[Bound $\NLtD{\thetah}$ by $\Nfn{p-1,h}{\thetah}$]\label{lem:ltthetahbound}
There exist constants $\Cfirst, \Csecond > 0$ such that
\beq\label{eq:ltthetahbound}
\NLtD{\thetah} \leq \Cfirst \mleft(\CFEMotilde h + \CFEMttilde \CAnk (hk)^p\mright) \NW{\rho} + \Csecond k^2h^p \mleft(\CFEMotilde h + \CFEMttilde \CAnk (hk)^p\mright) \Nfn{p-1,h}{\thetah}.
\eeq
where $\Cfirst, \Csecond$ are defined in \cref{app:constants}.
\ele

\bpf[Proof of \cref{lem:ltthetahbound}]
The proof initially uses a standard duality technique, but then becomes more complex than standard proofs, as we are bounding $\thetah$ by its higher-order discrete norms, rather than the error $\eh$ by its $H^1$ norm.
Consider the adjoint variational problem: Find $w \in \HozDD$ such that for all $v \in \HozDD$
\beq\label{eq:adjointtheta}
a(v,w) = \IPLtD{v}{\thetah}
\eeq
(i.e., $w$ solves the adjoint problem with right-hand side given by $\thetah$). Let $\eh \de u -\uh$ be the finite-element error, and put $v = \thetah$ in \cref{eq:adjointtheta}. By Galerkin orthogonality for $\eh,$ we have
\begin{align}
\IPLtD{\eh}{\thetah} = a(\eh,w-\Ph w) &= \IPLtD{A \grad \rho}{\grad(w-\Ph w)} + \IPLtD{A \grad \thetah}{\grad(w-\Ph w)}\\
&\quad\quad -k^2 \IPLtDn{\eh}{w-\Ph w} -ik \IPLtGI{\eh}{w-\Ph w}\nonumber\\
&= \IPLtD{A \grad \rho}{\grad(w-\Ph w)} + -k^2 \IPLtDn{\eh}{w-\Ph w} -ik \IPLtGI{\eh}{w-\Ph w},\label{eq:doublego}
\end{align}
by Galerkin orthogonality for $w - \Ph w.$ Therefore, as $\eh = \thetah + \rho,$ we can rearrange \cref{eq:doublego} to obtain
\begin{align}
\NLtD{\thetah}^2 &= a(\rho,w - \Ph w) -k^2 \IPLtDn{\thetah}{w-\Ph w} -ik \IPLtGI{\thetah}{w - \Ph w} - \IPLtD{\rho,\thetah}\nonumber\\
&\leq \Cc \NW{\rho} \NW{w- \Ph w} + k^2 \abs{\IPLtDn{\thetah}{w- \Ph w}} + k \abs{\IPLtGI{\thetah}{w-\Ph w}} + \NLtD{\rho}\NLtD{\thetah}\label{eq:boundingLtwo}
\end{align}
By combining \cref{lem:bestapprox,lem:ellprojerr}, we can show (as $w$ satisfies an adjoint Helmholtz problem with right-hand side $\thetah$)
\beq\label{eq:wlt}
\NLtD{w - \Ph w} \leq \Cfn{0,1} h \mleft(\CFEMotilde h + \CFEMttilde \CAnk (hk)^p\mright)\NLtD{\thetah} \tand
\eeq
\beq\label{eq:who}
\NHoD{w - \Ph w} \leq \Cfn{-1,1} \mleft(\CFEMotilde h + \CFEMttilde \CAnk (hk)^p\mright)\NLtD{\thetah}.
\eeq
We will be able to use \cref{eq:wlt,eq:who} to bound terms involving $w - \Ph w$ in \cref{eq:boundingLtwo}. We first estimate the inner product terms in \cref{eq:boundingLtwo}:
\begin{align}
\abs{\IPLtDn{\thetah}{w- \Ph w}} &= \abs{\IPLtDn{\thetah}{\Qhn w - \Ph w}}\nonumber\\
&\leq \Nfn{p-1,h,n}{\thetah}\Nfn{1-p,h,n}{\Qhn w = \Ph w}\text{ by \cref{lem:intoip}}\nonumber\\
& \Nfn{p-1,h,n}{\thetah} \Csumfn{p-1} \NLiD{n} \sum_{m=0}^{p-1} h^{p-1-m}\mleft(\NHmmD{\Qhn w - w} + \NHmmD{w - \Ph w}\mright) \text{ by \cref{lem:negdiscsum}}\nonumber\\
&\leq \Nfn{p-1,h}{\thetah} \Csumfn{p-1} \NLiD{n}^2 h^{p-1} \sum_{m=0}^{p-1} \mleft(\frac{\Cfn{n,-m,0}}{\nmin} \NLtD{w - \Ph w} + \Cfn{-m,1} h \NHoD{w - \Ph w}\mright)\\
&\quad\quad\text{ by \cref{lem:wltdprojerr,lem:ellprojerr}, taking $\wh = \Ph u$ in \cref{eq:wltdprojerr,eq:ellprojerr}}\nonumber\\
&\leq \Nfn{p-1,h}{\thetah} \Csumfn{p-1}\mleft(\sum_{m=0}^{p-1} \Cfn{-n,m,0}\Cfn{0,1} + \Cfn{-m,1}\Cfn{-1,1}\mright) \frac{\NLiD{n}^2}{\nmin}\\
&\quad\quad h^p \mleft(\CFEMotilde h + \CFEMttilde \CAnk (hk)^p\mright) \NLtD{\thetah} \text{ by \cref{eq:wlt,eq:who}}.\nonumber\\
&=\Nfn{p-1,h}{\thetah}  \Cfourteen \frac{\NLiD{n}^2}{\nmin} h^p \mleft(\CFEMotilde h + \CFEMttilde \CAnk (hk)^p\mright) \NLtD{\thetah} \label{eq:innerprod1},
\end{align}
where $\Cfourteen$ is defined in \cref{app:constants}. We now estimate the other inner product term
\begin{align}
\abs{\IPLtGI{\thetah}{w - \Ph w}} &\leq \mleft(\sqrt{2} \Cmess\NLiD{n}^2 k h^{p-\half} \Nfn{p-1,h}{\thetah} + \sqrt{\half + \half \CMT^2 \Cfn{0,1}} h^{\half} \NW{\rho}\mright) \NLtGI{w - \Ph w}\\
&\quad\quad\text{ by \cref{lem:boundarybound,eq:simple}}\nonumber\\
&\leq \CMT \Cfn{-1,}^{\half}\Cfn{-1,1}^{\half} \mleft(\sqrt{2} \Cmess \NLiD{n}^2 kh^p \Nfn{p-1,h}{\thetah} + \sqrt{\half + \half \CMT^2 \Cfn{0,1}} h \NW{\rho}\mright)\nonumber\\
&\quad\quad\mleft(\CFEMotilde h + \CFEMttilde \CAnk (hk)^p\mright) \NLtD{\thetah}\label{eq:innerprod2}
\end{align}
 by the \cref{thm:multiplicativetrace,eq:wlt,eq:who}.

Now insert \cref{eq:wlt,eq:who,eq:innerprod1,eq:innerprod2} into \cref{eq:boundingLtwo}:
\begin{align*}
\NLtD{\thetah}^2 &\leq \Big(\Cc \NW{\rho} \mleft(\Cfn{0,1} + \Cfn{1,1}\mright) + k^2 \Cfourteen \Nfn{p-1,h} h^p +\\
&k\mleft(\sqrt{2} \Cmess \NLiD{n}^2 kh^p \Nfn{p-1,h}{\thetah} + \sqrt{\half + \half\CMT^2 \Cfn{0,1}}h \NW{\rho}\mright)\CMT\Cfn{0,1}^{\half}\Cfn{-1,1}^{\half}\Big)\\
&\mleft(\CFEMotilde h + \CFEMttilde \CAnk (hk)^p\mright) \NLtD{\thetah}
\end{align*}
and therefore using Young's inequality to separate out the $\NLtD{\thetah}$ term on the right-hand side, and then move it to the left hand side, followed by \cref{eq:simple}, we obtain
\begin{align}\label{eq:part3penultimate}
\NLtD{\thetah} &\leq \mleft(\Cc \NW{\rho} \mleft(\Cfn{0,1} + \Cfn{1,1}\mright) + k^2 \Cfourteen \Nfn{p-1,h} h^p\mright.\\
&\quad\quad\mleft.+ k\mleft(\sqrt{2} \Cmess \NLiD{n}^2 kh^p \Nfn{p-1,h}{\thetah} + \sqrt{\half + \half\CMT^2 \Cfn{0,1}}h \NW{\rho}\mright)\CMT\Cfn{0,1}^{\half}\Cfn{-1,1}^{\half}\mright)\\& \mleft(\CFEMotilde h + \CFEMttilde \CAnk (hk)^p\mright).
\end{align}
As $hk \leq 1,$ we simplify \cref{eq:part3penultimate} to obtain \cref{eq:ltthetahbound}.
\epf

With all our technical lemmas proved, we can now prove our main \namecref{thm:fembound}.

\bpf[Proof of \cref{thm:fembound}]
By using \cref{lem:higherbound} (with $m=p-1$) in \cref{eq:ltthetahbound}, we have
\begin{align}\label{eq:doublehkdep}
\NLtD{\thetah} &\leq \mleft(\Cfirst+ \Csecond \mleft(\sum_{j=0}^{p-1} \CReco^j \CRect^j\mright)\mright) \mleft(\CFEMotilde h + \CFEMttilde \CAnk (hk)^p\mright)\NW{\rho}\nonumber\\
&\quad\quad+ \Csecond \CReco^{p-1} \NLtD{\thetah}\mleft(\CFEMotilde (hk)^{p+1} + \CFEMttilde \CAnk k(hk)^{2p}\mright).
\end{align}
Choosing $h$ according to \cref{eq:hfemcond}, \cref{eq:doublehkdep} simplifies to
\beqs
\NLtD{\thetah} \leq \mleft(\Cfirst+ \Csecond \mleft(\sum_{j=0}^{p-1} \CReco^j \CRect^j\mright)\mright) \mleft(\CFEMotilde h + \CFEMttilde \CAnk (hk)^p\mright)\NW{\rho} + \half \NLtD{\thetah},
\eeqs
and therefore it follows that
\beq\label{eq:ltboundwithrho}
\NLtD{\thetah} \leq \mleft(\CLtboundo h + \CLtboundt \CAnk (hk)^p\mright)\NW{\rho},
\eeq
where
\beqs
\CLtboundo = \mleft(\Cfirst+ \Csecond \mleft(\sum_{j=0}^{p-1} \CReco^j \CRect^j\mright)\mright) \CFEMotilde \tand
\eeqs
\beqs
\CLtboundt = \mleft(\Cfirst+ \Csecond \mleft(\sum_{j=0}^{p-1} \CReco^j \CRect^j\mright)\mright)\CFEMttilde.
\eeqs
It only now remains to bound the weighted $H^1$ norm of the error. By \cref{lem:h1contdisc,lem:higherbound} (with $m=1$) we have
\beq\label{eq:sntheta}
\SNHoD{\thetah} \leq \Amin^{\half} \mleft(\Chighfn{1,1} k \NLtD{\thetah} + \Chighfn{1,2} \NW{\rho}\mright),
\eeq
and by combining \cref{eq:sntheta,eq:ltboundwithrho} we obtain (as $hk \leq 1$)
\beqs
\SNHoD{\thetah} \leq \mleft(\CHoboundo + \CHoboundt \CAnk k(hk)^p\mright)\NW{\rho},
\eeqs
where
\beqs
\CHoboundo = \Amin^{\half} \mleft(\Chighfn{1,1}\CLtboundo + \Chighfn{1,2}\mright)\tand
\eeqs
\beqs
\CHoboundt = \Amin^{\half} \mleft(\Chighfn{1,1}\CLtboundt\mright).
\eeqs
Therefore, by \cref{lem:ellprojerr,lem:bestapprox}, and the fact that $hk \leq 1,$ we obtain \cref{eq:femltbound,eq:femhobound}, where
\beqs
\CFEMLt = \Cfn{-1,1} \max\set{\CLtboundo,\CLtboundt}\tand
\eeqs
\beqs
\CFEMHo = \Cfn{-1,1}\max\set{\CHoboundo,\CHoboundt}.
\eeqs
\epf

From \cref{thm:fembound,lem:scottzhang} we have the following corollary, with $\CcorLt = \CFEMLt\mleft(\CFEMo+\CFEMt\mright)$ and $\CcorHo = \CFEMHo\mleft(\CFEMotilde+\CFEMttilde\mright)$

\bco[Completely explicit FEM bound]\label{cor:fembound}
Under the assumptions on \cref{thm:fembound},
\beqs
\NLtD{u-\uh} \leq \CcorLt \mleft(h^3 + \CAnk h^2 (hk)^p + \CAnk^2 (hk)^{2p}\mright)\Cfg\tand
\eeqs
\beqs
\NW{u-\uh} \leq \CcorHo \mleft(h + \CAnk (hk)^p + \CAnk^2 (hk)^{2p}\mright)\Cfg.
\eeqs
\eco\optodo{I'm suspicious about two orders of magnitude...}

Put the following somewhere:
For $a,b > 0$\optodo{Extend to many}
\beq\label{eq:simple}
\sqrt{a^2 + b^2} \leq a + b.
\eeq

And this:
\bth[Multiplicative Trace Inequality]\label{thm:multiplicativetrace}%BS THm 1.6.6
There exists $\CMT > 0$ such that for all $v \in \HoD$
\beqs
\NLtdD{v} \leq \CMT \NLtD{v}^\half \NHoD{D}^\half.
\eeqs
\enth
